!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@galacean/engine")):"function"==typeof define&&define.amd?define(["exports","@galacean/engine"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).Galacean=t.Galacean||{},t.Galacean.PhysicsPhysX={}),t.Galacean)}(this,function(t,e){"use strict";function i(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function n(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}var o,r=/*#__PURE__*/function(){function t(t){this._controllers=new e.DisorderedArray,this._worldScale=new e.Vector3(1,1,1),this._position=new e.Vector3,this._rotation=null,this._axis=null,this._physXRotation=new e.Quaternion,this._shapeFlags=3,this._physXPhysics=t}var i=t.prototype;return i.setRotation=function(t){this._rotation=t,e.Quaternion.rotationYawPitchRoll(t.x,t.y,t.z,this._physXRotation),this._axis&&e.Quaternion.multiply(this._physXRotation,this._axis,this._physXRotation),this._physXRotation.normalize(),this._setLocalPose()},i.setPosition=function(t){t!==this._position&&this._position.copyFrom(t);for(var e=this._controllers,i=0,s=e.length;i<s;i++)e.get(i)._updateShapePosition(this._position,this._worldScale);this._setLocalPose()},i.setWorldScale=function(t){this._worldScale.copyFrom(t),this._setLocalPose();for(var e=this._controllers,i=0,s=e.length;i<s;i++)e.get(i)._updateShapePosition(this._position,this._worldScale)},i.setContactOffset=function(t){this._pxShape.setContactOffset(t);for(var e,i=this._controllers,s=0,n=i.length;s<n;s++)null==(e=i.get(s)._pxController)||e.setContactOffset(t)},i.setMaterial=function(t){this._pxMaterial=t._pxMaterial,this._pxShape.setMaterial(this._pxMaterial)},i.setIsTrigger=function(t){this._modifyFlag(1,!t),this._modifyFlag(4,t),this._setShapeFlags(this._shapeFlags)},i.destroy=function(){this._pxShape.release()},i._setShapeFlags=function(t){this._shapeFlags=t,this._pxShape.setFlags(new this._physXPhysics._physX.PxShapeFlags(this._shapeFlags))},i._setLocalPose=function(){var i=t.transform;e.Vector3.multiply(this._position,this._worldScale,i.translation),i.rotation=this._physXRotation,this._pxShape.setLocalPose(i)},i._initialize=function(t,e){this._id=e,this._pxMaterial=t._pxMaterial,this._pxShape=this._physXPhysics._pxPhysics.createShape(this._pxGeometry,t._pxMaterial,!0,new this._physXPhysics._physX.PxShapeFlags(this._shapeFlags)),this._pxShape.setUUID(e)},i._modifyFlag=function(t,e){this._shapeFlags=e?this._shapeFlags|t:this._shapeFlags&~t},t}();r.halfSqrt=.70710678118655,r.transform={translation:new e.Vector3,rotation:null};var a=/*#__PURE__*/function(t){function i(i,s,n,o){(r=t.call(this,i)||this)._halfSize=new e.Vector3,r._sizeScale=new e.Vector3(1,1,1);var r,a=r._halfSize;return a.set(.5*n.x,.5*n.y,.5*n.z),r._pxGeometry=new i._physX.PxBoxGeometry(a.x,a.y,a.z),r._initialize(o,s),r._setLocalPose(),r}n(i,t);var s=i.prototype;return s.setSize=function(t){var s=this._halfSize,n=i._tempHalfExtents;s.set(.5*t.x,.5*t.y,.5*t.z),e.Vector3.multiply(s,this._sizeScale,n),this._pxGeometry.halfExtents=n,this._pxShape.setGeometry(this._pxGeometry),this._updateController(n)},s.setWorldScale=function(s){t.prototype.setWorldScale.call(this,s),this._sizeScale.set(Math.abs(s.x),Math.abs(s.y),Math.abs(s.z));var n=i._tempHalfExtents;e.Vector3.multiply(this._halfSize,this._sizeScale,n),this._pxGeometry.halfExtents=n,this._pxShape.setGeometry(this._pxGeometry),this._updateController(n)},s._updateController=function(t){for(var e=this._controllers,i=0,s=e.length;i<s;i++){var n=e.get(i)._pxController;n&&(n.setHalfHeight(t.x),n.setHalfSideExtent(t.y),n.setHalfForwardExtent(t.z))}},i}(r);a._tempHalfExtents=new e.Vector3;var l=/*#__PURE__*/function(t){function i(i,s,n,o,a){var l;return(l=t.call(this,i)||this)._upAxis=1,l._sizeScale=new e.Vector3(1,1,1),l._radius=n,l._halfHeight=.5*o,l._axis=new e.Quaternion(0,0,r.halfSqrt,r.halfSqrt),l._physXRotation.copyFrom(l._axis),l._pxGeometry=new i._physX.PxCapsuleGeometry(l._radius,l._halfHeight),l._initialize(a,s),l._setLocalPose(),l}n(i,t);var s=i.prototype;return s.setRadius=function(t){this._radius=t;var e,i=this._sizeScale;switch(this._upAxis){case 0:this._pxGeometry.radius=this._radius*Math.max(i.y,i.z);break;case 1:this._pxGeometry.radius=this._radius*Math.max(i.x,i.z);break;case 2:this._pxGeometry.radius=this._radius*Math.max(i.x,i.y)}this._pxShape.setGeometry(this._pxGeometry);for(var s=this._pxGeometry.radius,n=this._controllers,o=0,r=n.length;o<r;o++)null==(e=n.get(o)._pxController)||e.setRadius(s)},s.setHeight=function(t){this._halfHeight=.5*t;var e,i=this._sizeScale;switch(this._upAxis){case 0:this._pxGeometry.halfHeight=this._halfHeight*i.x;break;case 1:this._pxGeometry.halfHeight=this._halfHeight*i.y;break;case 2:this._pxGeometry.halfHeight=this._halfHeight*i.z}this._pxShape.setGeometry(this._pxGeometry);for(var s=2*this._pxGeometry.halfHeight,n=this._controllers,o=0,r=n.length;o<r;o++)null==(e=n.get(o)._pxController)||e.setHeight(s)},s.setUpAxis=function(t){var i=this._rotation,s=this._axis,n=this._physXRotation;switch(this._upAxis=t,this._upAxis){case 0:s.set(0,0,0,1);break;case 1:s.set(0,0,r.halfSqrt,r.halfSqrt);break;case 2:s.set(0,r.halfSqrt,0,r.halfSqrt)}i?(e.Quaternion.rotationYawPitchRoll(i.x,i.y,i.z,n),e.Quaternion.multiply(n,s,n)):n.copyFrom(s),this._setLocalPose()},s.setWorldScale=function(e){t.prototype.setWorldScale.call(this,e);var i=this._sizeScale.set(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),s=this._pxGeometry;switch(this._upAxis){case 0:s.radius=this._radius*Math.max(i.y,i.z),s.halfHeight=this._halfHeight*i.x;break;case 1:s.radius=this._radius*Math.max(i.x,i.z),s.halfHeight=this._halfHeight*i.y;break;case 2:s.radius=this._radius*Math.max(i.x,i.y),s.halfHeight=this._halfHeight*i.z}this._pxShape.setGeometry(s);for(var n=s.radius,o=2*s.halfHeight,r=this._controllers,a=0,l=r.length;a<l;a++){var h=r.get(a)._pxController;h&&(h.setRadius(n),h.setHeight(o))}},i}(r),h=/*#__PURE__*/function(){function t(t){this._shapeScaledPosition=new e.Vector3,this._worldPosition=null,this._physXPhysics=t}var s=t.prototype;return s.move=function(t,e,i){var s,n;return null!=(n=null==(s=this._pxController)?void 0:s.move(t,e,i))?n:0},s.setWorldPosition=function(t){this._worldPosition=t,this._updateNativePosition()},s.getWorldPosition=function(t){this._pxController&&(t.copyFrom(this._pxController.getPosition()),t.subtract(this._shapeScaledPosition))},s.setStepOffset=function(t){var e;null==(e=this._pxController)||e.setStepOffset(t)},s.setNonWalkableMode=function(t){var e;null==(e=this._pxController)||e.setNonWalkableMode(t)},s.setUpDirection=function(t){var e;null==(e=this._pxController)||e.setUpDirection(t)},s.setSlopeLimit=function(t){var e;null==(e=this._pxController)||e.setSlopeLimit(t)},s.addShape=function(t){this._pxManager&&this._createPXController(this._pxManager,t),this._shape=t,t._controllers.add(this)},s.removeShape=function(t){this._destroyPXController(),this._shape=null,t._controllers.delete(this)},s.destroy=function(){this._destroyPXController()},s._createPXController=function(t,e){var s;if(i(e,a))(s=new this._physXPhysics._physX.PxBoxControllerDesc).halfHeight=e._halfSize.x,s.halfSideExtent=e._halfSize.y,s.halfForwardExtent=e._halfSize.z;else if(i(e,l))(s=new this._physXPhysics._physX.PxCapsuleControllerDesc).radius=e._radius,s.height=2*e._halfHeight,s.climbingMode=1;else throw"unsupported shape type";s.setMaterial(e._pxMaterial),this._pxController=t._getControllerManager().createController(s),this._pxController.setUUID(e._id)},s._destroyPXController=function(){this._pxController&&(this._pxController.release(),this._pxController=null)},s._updateShapePosition=function(t,i){e.Vector3.multiply(t,i,this._shapeScaledPosition),this._updateNativePosition()},s._updateNativePosition=function(){var i=this._worldPosition;this._pxController&&i&&(e.Vector3.add(i,this._shapeScaledPosition,t._tempVec),this._pxController.setPosition(t._tempVec))},t}();h._tempVec=new e.Vector3;var c=/*#__PURE__*/function(){function t(t){this._physXPhysics=t}var e=t.prototype;return e.addShape=function(t){this._pxActor.attachShape(t._pxShape)},e.removeShape=function(t){this._pxActor.detachShape(t._pxShape,!0)},e.setWorldTransform=function(t,e){this._pxActor.setGlobalPose(this._transform(t,e),!0)},e.getWorldTransform=function(t,e){var i=this._pxActor.getGlobalPose();t.set(i.translation.x,i.translation.y,i.translation.z),e.set(i.rotation.x,i.rotation.y,i.rotation.z,i.rotation.w)},e.destroy=function(){this._pxActor.release()},e._transform=function(e,i){var s=t._tempTransform;return s.translation=e,s.rotation=i.normalize(),s},t}();c._tempTransform={translation:null,rotation:null};var _=/*#__PURE__*/function(t){function s(e,i,s){var n,o=(n=t.call(this,e)||this)._transform(i,s);return n._pxActor=e._pxPhysics.createRigidDynamic(o),n}n(s,t);var o=s.prototype;return o.setLinearDamping=function(t){this._pxActor.setLinearDamping(t)},o.setAngularDamping=function(t){this._pxActor.setAngularDamping(t)},o.setLinearVelocity=function(t){this._pxActor.setLinearVelocity(t,!0)},o.setAngularVelocity=function(t){this._pxActor.setAngularVelocity(t,!0)},o.setMass=function(t){this._pxActor.setMass(t)},o.setCenterOfMass=function(t){this._pxActor.setCMassLocalPose(t)},o.setInertiaTensor=function(t){this._pxActor.setMassSpaceInertiaTensor(t)},o.setMaxAngularVelocity=function(t){this._pxActor.setMaxAngularVelocity(t)},o.setMaxDepenetrationVelocity=function(t){this._pxActor.setMaxDepenetrationVelocity(t)},o.setSleepThreshold=function(t){this._pxActor.setSleepThreshold(t)},o.setSolverIterations=function(t){this._pxActor.setSolverIterationCounts(t,1)},o.setCollisionDetectionMode=function(t){switch(t){case 1:this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eENABLE_CCD,!0);break;case 2:this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eENABLE_CCD_FRICTION,!0);break;case 3:this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eENABLE_SPECULATIVE_CCD,!0);break;case 0:var e=this._physXPhysics._physX;this._pxActor.setRigidBodyFlag(e.PxRigidBodyFlag.eENABLE_CCD,!1),this._pxActor.setRigidBodyFlag(e.PxRigidBodyFlag.eENABLE_CCD_FRICTION,!1),this._pxActor.setRigidBodyFlag(e.PxRigidBodyFlag.eENABLE_SPECULATIVE_CCD,!1)}},o.setIsKinematic=function(t){t?this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eKINEMATIC,!0):this._pxActor.setRigidBodyFlag(this._physXPhysics._physX.PxRigidBodyFlag.eKINEMATIC,!1)},o.setConstraints=function(t){this._pxActor.setRigidDynamicLockFlags(t)},o.addForce=function(t){this._pxActor.addForce({x:t.x,y:t.y,z:t.z})},o.addTorque=function(t){this._pxActor.addTorque({x:t.x,y:t.y,z:t.z})},o.move=function(t,n){if(n){this._pxActor.setKinematicTarget(t,n);return}var o=s._tempTranslation,r=s._tempRotation;this.getWorldTransform(o,r),i(t,e.Vector3)?this._pxActor.setKinematicTarget(t,r):this._pxActor.setKinematicTarget(o,t)},o.sleep=function(){return this._pxActor.putToSleep()},o.wakeUp=function(){return this._pxActor.wakeUp()},s}(c);_._tempTranslation=new e.Vector3,_._tempRotation=new e.Quaternion;var p=function(){this._eventMap={}},u=/*#__PURE__*/function(){function t(t,e,i,s,n,o){this._physXPhysics=t;var r=t._pxPhysics.createMaterial(e,i,s);r.setFrictionCombineMode(n),r.setRestitutionCombineMode(o),this._pxMaterial=r}var e=t.prototype;return e.setBounciness=function(t){this._pxMaterial.setRestitution(t)},e.setDynamicFriction=function(t){this._pxMaterial.setDynamicFriction(t)},e.setStaticFriction=function(t){this._pxMaterial.setStaticFriction(t)},e.setBounceCombine=function(t){this._pxMaterial.setRestitutionCombineMode(t)},e.setFrictionCombine=function(t){this._pxMaterial.setFrictionCombineMode(t)},e.destroy=function(){this._pxMaterial.release()},t}(),f=/*#__PURE__*/function(){function t(t,i,s,n,o,r,a,l){var h=this;this._pxControllerManager=null,this._currentEvents=new e.DisorderedArray,this._eventPool=[],this._physXPhysics=t,this._physXManager=i;var c=t._physX;this._pxRaycastHit=new c.PxRaycastHit,this._pxFilterData=new c.PxQueryFilterData,this._pxFilterData.flags=new c.PxQueryFlags(7),this._onContactEnter=s,this._onContactExit=n,this._onContactStay=o,this._onTriggerEnter=r,this._onTriggerExit=a,this._onTriggerStay=l;var _=t._pxPhysics,p=c.PxSimulationEventCallback.implement({onContactBegin:function(t,e){h._onContactEnter(t,e)},onContactEnd:function(t,e){h._onContactExit(t,e)},onContactPersist:function(t,e){h._onContactStay(t,e)},onTriggerBegin:function(t,e){var i=t<e?h._getTrigger(t,e):h._getTrigger(e,t);i.state=0,h._currentEvents.add(i)},onTriggerEnd:function(t,e){var i;if(t<e){var s=h._physXManager._eventMap[t];i=s[e],s[e]=void 0}else{var n=h._physXManager._eventMap[e];i=n[t],n[t]=void 0}i.state=2}}),u=c.getDefaultSceneDesc(_.getTolerancesScale(),0,p);this._pxScene=_.createScene(u)}var i=t.prototype;return i.setGravity=function(t){this._pxScene.setGravity(t)},i.addColliderShape=function(t){this._physXManager._eventMap[t._id]={}},i.removeColliderShape=function(t){var e=this._eventPool,i=this._currentEvents,s=t._id,n=this._physXManager._eventMap;i.forEach(function(t,o){t.index1==s?(i.deleteByIndex(o),e.push(t)):t.index2==s&&(i.deleteByIndex(o),e.push(t),n[t.index1][s]=void 0)}),delete n[s]},i.addCollider=function(t){this._pxScene.addActor(t._pxActor,null)},i.removeCollider=function(t){this._pxScene.removeActor(t._pxActor,!0)},i.addCharacterController=function(t){if(!t._pxController){var e=t._shape;if(e){var i=t._pxManager;i!==this&&(i&&t._destroyPXController(),t._createPXController(this,e))}}t._pxManager=this},i.removeCharacterController=function(t){t._pxManager=null},i.update=function(t){this._simulate(t),this._fetchResults(),this._fireEvent()},i.raycast=function(e,i,s,n){var o=this._pxRaycastHit;i=Math.min(i,34e37);var r=this._pxScene.raycastSingle(e.origin,e.direction,i,o,this._pxFilterData,this._physXPhysics._physX.PxQueryFilterCallback.implement({preFilter:function(t,e,i){return s(e)?2:0},postFilter:function(t,e){}}));if(r&&void 0!=n){var a=t._tempPosition,l=t._tempNormal,h=o.position,c=o.normal;a.set(h.x,h.y,h.z),l.set(c.x,c.y,c.z),n(o.getShape().getUUID(),o.distance,a,l)}return r},i._getControllerManager=function(){var t=this._pxControllerManager;return null===t&&(this._pxControllerManager=t=this._pxScene.createControllerManager()),t},i._simulate=function(t){this._pxScene.simulate(t,!0)},i._fetchResults=function(t){void 0===t&&(t=!0),this._pxScene.fetchResults(t)},i._getTrigger=function(t,e){var i;return this._eventPool.length?((i=this._eventPool.pop()).index1=t,i.index2=e):i=new x(t,e),this._physXManager._eventMap[t][e]=i,i},i._fireEvent=function(){var t=this,e=this._eventPool,i=this._currentEvents;i.forEach(function(s,n){0==s.state?(t._onTriggerEnter(s.index1,s.index2),s.state=1):1==s.state?t._onTriggerStay(s.index1,s.index2):2==s.state&&(i.deleteByIndex(n),t._onTriggerExit(s.index1,s.index2),e.push(s))})},t}();f._tempPosition=new e.Vector3,f._tempNormal=new e.Vector3;var x=function(t,e){this.index1=t,this.index2=e},y=/*#__PURE__*/function(t){function e(e,i,s){var n;return(n=t.call(this,e)||this)._pxActor=e._pxPhysics.createRigidStatic(n._transform(i,s)),n}return n(e,t),e}(c),d=((o={})[o.Auto=0]="Auto",o[o.WebAssembly=1]="WebAssembly",o[o.JavaScript=2]="JavaScript",o),g=/*#__PURE__*/function(){function t(t){this._connectedAnchor=new e.Vector3,this._breakForce=Number.MAX_VALUE,this._breakTorque=Number.MAX_VALUE,this._physXPhysics=t}var i=t.prototype;return i.setConnectedCollider=function(t){var e;this._pxJoint.setActors((null==t?void 0:t._pxActor)||null,(null==(e=this._collider)?void 0:e._pxActor)||null)},i.setConnectedAnchor=function(e){this._connectedAnchor.copyFrom(e),this._setLocalPose(0,e,t._defaultQuat)},i.setConnectedMassScale=function(t){this._pxJoint.setInvMassScale0(1/t)},i.setConnectedInertiaScale=function(t){this._pxJoint.setInvInertiaScale0(1/t)},i.setMassScale=function(t){this._pxJoint.setInvMassScale1(1/t)},i.setInertiaScale=function(t){this._pxJoint.setInvInertiaScale1(1/t)},i.setBreakForce=function(t){this._breakForce=t,this._pxJoint.setBreakForce(this._breakForce,this._breakTorque)},i.setBreakTorque=function(t){this._breakTorque=t,this._pxJoint.setBreakForce(this._breakForce,this._breakTorque)},i._setLocalPose=function(t,e,i){this._pxJoint.setLocalPose(t,e,i)},t}();g._xAxis=new e.Vector3(1,0,0),g._defaultVec=new e.Vector3,g._defaultQuat=new e.Quaternion;var m=/*#__PURE__*/function(t){function e(e,i){var s;return(s=t.call(this,e)||this)._collider=i,s._pxJoint=e._pxPhysics.createFixedJoint(null,g._defaultVec,g._defaultQuat,i._pxActor,g._defaultVec,g._defaultQuat),s}return n(e,t),e}(g),S=/*#__PURE__*/function(t){function i(i,s){var n;return(n=t.call(this,i)||this)._axisRotationQuaternion=new e.Quaternion,n._swingOffset=new e.Vector3,n._collider=s,n._pxJoint=i._pxPhysics.createRevoluteJoint(null,g._defaultVec,g._defaultQuat,s._pxActor,g._defaultVec,g._defaultQuat),n}n(i,t);var s=i.prototype;return s.setAxis=function(t){var i=g._xAxis,s=this._axisRotationQuaternion;i.set(1,0,0),t.normalize();var n=Math.acos(e.Vector3.dot(i,t));e.Vector3.cross(i,t,i),e.Quaternion.rotationAxisAngle(i,n,s),this._setLocalPose(0,this._swingOffset,s)},s.setSwingOffset=function(t){this._swingOffset.copyFrom(t),this._setLocalPose(1,this._swingOffset,this._axisRotationQuaternion)},s.getAngle=function(){return this._pxJoint.getAngle()},s.getVelocity=function(){return this._pxJoint.getVelocity()},s.setHardLimit=function(t,e,i){this._pxJoint.setHardLimit(t,e,i)},s.setSoftLimit=function(t,e,i,s){this._pxJoint.setSoftLimit(t,e,i,s)},s.setDriveVelocity=function(t,e){void 0===e&&(e=!0),this._pxJoint.setDriveVelocity(t,e)},s.setDriveForceLimit=function(t){this._pxJoint.setDriveForceLimit(t)},s.setDriveGearRatio=function(t){this._pxJoint.setDriveGearRatio(t)},s.setHingeJointFlag=function(t,e){this._pxJoint.setRevoluteJointFlag(t,e)},i}(g),v=/*#__PURE__*/function(t){function i(i,s){var n;return(n=t.call(this,i)||this)._swingOffset=new e.Vector3,n._collider=s,n._pxJoint=i._pxPhysics.createDistanceJoint(null,g._defaultVec,g._defaultQuat,s._pxActor,g._defaultVec,g._defaultQuat),n._pxJoint.setDistanceJointFlag(2,!0),n._pxJoint.setDistanceJointFlag(4,!0),n._pxJoint.setDistanceJointFlag(8,!0),n}n(i,t);var s=i.prototype;return s.setSwingOffset=function(t){this._swingOffset.copyFrom(t),this._setLocalPose(1,t,g._defaultQuat)},s.setMinDistance=function(t){this._pxJoint.setMinDistance(t)},s.setMaxDistance=function(t){this._pxJoint.setMaxDistance(t)},s.setTolerance=function(t){this._pxJoint.setTolerance(t)},s.setStiffness=function(t){this._pxJoint.setStiffness(t)},s.setDamping=function(t){this._pxJoint.setDamping(t)},i}(g),P=/*#__PURE__*/function(t){function i(i,s,n){var o;return(o=t.call(this,i)||this)._axis=new e.Quaternion(0,0,r.halfSqrt,r.halfSqrt),o._physXRotation.copyFrom(o._axis),o._pxGeometry=new i._physX.PxPlaneGeometry,o._initialize(n,s),o._setLocalPose(),o}return n(i,t),i}(r),A=/*#__PURE__*/function(t){function e(e,i,s,n){var o;return(o=t.call(this,e)||this)._maxScale=1,o._radius=s,o._pxGeometry=new e._physX.PxSphereGeometry(o._radius*o._maxScale),o._initialize(n,i),o._setLocalPose(),o}n(e,t);var i=e.prototype;return i.setRadius=function(t){this._radius=t,this._pxGeometry.radius=t*this._maxScale,this._pxShape.setGeometry(this._pxGeometry)},i.setWorldScale=function(e){t.prototype.setWorldScale.call(this,e),this._maxScale=Math.max(Math.abs(e.x),Math.abs(e.y),Math.abs(e.z)),this._pxGeometry.radius=this._radius*this._maxScale,this._pxShape.setGeometry(this._pxGeometry)},e}(r),C=/*#__PURE__*/function(){function t(t){void 0===t&&(t=d.Auto),this._initializeState=0,this._runTimeMode=t}var e=t.prototype;return e.initialize=function(){var t=this;if(2===this._initializeState)return Promise.resolve();if(1===this._initializeState)return this._initializePromise;var e=this._runTimeMode,s=new Promise(function(t,s){var n=document.createElement("script");document.body.appendChild(n),n.async=!0,n.onload=t,n.onerror=s,e==d.Auto&&(e=!function(){try{var t;if(("undefined"==typeof WebAssembly?"undefined":(t=WebAssembly)&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t)=="object"&&"function"==typeof WebAssembly.instantiate){var e=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(i(e,WebAssembly.Module))return i(new WebAssembly.Instance(e),WebAssembly.Instance)}}catch(t){}return!1}()?d.JavaScript:d.WebAssembly),e==d.JavaScript?n.src="https://mdn.alipayobjects.com/rms/afts/file/A*rnDeR58NNGoAAAAAAAAAAAAAARQnAQ/physx.release.js.js":e==d.WebAssembly&&(n.src="https://mdn.alipayobjects.com/rms/afts/file/A*nA97QLQehRMAAAAAAAAAAAAAARQnAQ/physx.release.js")}),n=new Promise(function(e,i){s.then(function(){return window.PHYSX().then(function(i){t._init(i),t._initializeState=2,t._initializePromise=null,console.log("PhysX loaded."),e()},i)},i).catch(i)});return this._initializePromise=n,n},e.destroy=function(){this._physX.PxCloseExtensions(),this._pxPhysics.release(),this._pxFoundation.release(),this._physX=null,this._pxFoundation=null,this._pxPhysics=null},e.createPhysicsManager=function(){return new p},e.createPhysicsScene=function(t,e,i,s,n,o,r){return new f(this,t,e,i,s,n,o,r)},e.createStaticCollider=function(t,e){return new y(this,t,e)},e.createDynamicCollider=function(t,e){return new _(this,t,e)},e.createCharacterController=function(){return new h(this)},e.createPhysicsMaterial=function(t,e,i,s,n){return new u(this,t,e,i,s,n)},e.createBoxColliderShape=function(t,e,i){return new a(this,t,e,i)},e.createSphereColliderShape=function(t,e,i){return new A(this,t,e,i)},e.createPlaneColliderShape=function(t,e){return new P(this,t,e)},e.createCapsuleColliderShape=function(t,e,i,s){return new l(this,t,e,i,s)},e.createFixedJoint=function(t){return new m(this,t)},e.createHingeJoint=function(t){return new S(this,t)},e.createSpringJoint=function(t){return new v(this,t)},e._init=function(t){var e=t.PX_PHYSICS_VERSION,i=new t.PxDefaultErrorCallback,s=new t.PxDefaultAllocator,n=t.PxCreateFoundation(e,s,i),o=t.PxCreatePhysics(e,n,new t.PxTolerancesScale,!1,null);t.PxInitExtensions(o,null),this._physX=t,this._pxFoundation=n,this._pxPhysics=o},t}(),M="1.4.0-alpha.0";console.log("Galacean PhysX version: "+M),t.PhysXPhysics=C,t.PhysXRuntimeMode=d,t.version=M,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=browser.min.js.map
