{"version":3,"file":"TextureHook.js","sources":["../../../src/hooks/TextureHook.ts"],"sourcesContent":["import { log } from \"../log\";\n\n/**\n * @class TextureHook\n */\nexport default class TextureHook {\n  public textures: number = 0;\n  private readonly realCreateTexture: any;\n  private readonly realDeleteTexture: any;\n  private readonly gl: WebGLRenderingContext | WebGL2RenderingContext;\n  private hooked: boolean;\n\n  constructor(gl: WebGLRenderingContext | WebGL2RenderingContext) {\n    this.realCreateTexture = gl.createTexture;\n    this.realDeleteTexture = gl.deleteTexture;\n\n    gl.createTexture = this.hookedCreateTexture.bind(this);\n    gl.deleteTexture = this.hookedDeleteTexture.bind(this);\n\n    this.hooked = true;\n    this.gl = gl;\n\n    log(`Texture is hooked.`);\n  }\n\n  private hookedCreateTexture(): void {\n    let texture = this.realCreateTexture.call(this.gl);\n\n    this.textures++;\n\n    log(`CreateTexture:`, texture, `textures: ${this.textures}`);\n\n    return texture;\n  }\n\n  private hookedDeleteTexture(texture: any): void {\n    this.realDeleteTexture.call(this.gl, texture);\n\n    this.textures--;\n\n    log(`DeleteTexture. textures: ${this.textures}`);\n  }\n\n  public reset(): void {\n    this.textures = 0;\n  }\n\n  public release(): void {\n    if (this.hooked) {\n      this.gl.createTexture = this.realCreateTexture;\n      this.gl.deleteTexture = this.realDeleteTexture;\n    }\n\n    this.hooked = false;\n  }\n}\n"],"names":["TextureHook","gl","textures","realCreateTexture","createTexture","realDeleteTexture","deleteTexture","hookedCreateTexture","bind","hookedDeleteTexture","hooked","log","texture","call","reset","release"],"mappings":";;;AAKe,IAAMA,4BAAD,WAAL;AAAMA,IAAAA,SAAAA,WAAAA,CAOPC,EAAkD,EAAA;aANvDC,QAAmB,GAAA,CAAA,CAAA;AAOxB,QAAA,IAAI,CAACC,iBAAiB,GAAGF,EAAAA,CAAGG,aAAa,CAAA;AACzC,QAAA,IAAI,CAACC,iBAAiB,GAAGJ,EAAAA,CAAGK,aAAa,CAAA;QAEzCL,EAAGG,CAAAA,aAAa,GAAG,IAAI,CAACG,mBAAmB,CAACC,IAAI,CAAC,IAAI,CAAA,CAAA;QACrDP,EAAGK,CAAAA,aAAa,GAAG,IAAI,CAACG,mBAAmB,CAACD,IAAI,CAAC,IAAI,CAAA,CAAA;QAErD,IAAI,CAACE,MAAM,GAAG,IAAA,CAAA;QACd,IAAI,CAACT,EAAE,GAAGA,EAAAA,CAAAA;QAEVU,GAAK,CAAA,oBAAA,CAAA,CAAA;;AAjBYX,IAAAA,IAAAA,MAAAA,GAAAA,WAAAA,CAAAA,SAAAA,CAAAA;IAoBnB,MAAQO,CAAAA,mBAQP,GARD,SAAQA,mBAAAA,GAAAA;QACN,IAAIK,OAAAA,GAAU,IAAI,CAACT,iBAAiB,CAACU,IAAI,CAAC,IAAI,CAACZ,EAAE,CAAA,CAAA;AAEjD,QAAA,IAAI,CAACC,QAAQ,EAAA,CAAA;AAEbS,QAAAA,GAAAA,CAAK,kBAAiBC,OAAS,EAAC,YAAY,GAAA,IAAI,CAACV,QAAQ,CAAA,CAAA;QAEzD,OAAOU,OAAAA,CAAAA;AACT,KAAA,CAAA;AAEA,IAAA,MAAA,CAAQH,mBAMP,GAND,SAAQA,mBAAAA,CAAoBG,OAAY,EAAA;QACtC,IAAI,CAACP,iBAAiB,CAACQ,IAAI,CAAC,IAAI,CAACZ,EAAE,EAAEW,OAAAA,CAAAA,CAAAA;AAErC,QAAA,IAAI,CAACV,QAAQ,EAAA,CAAA;AAEbS,QAAAA,GAAAA,CAAI,2BAAC,GAA2B,IAAI,CAACT,QAAQ,CAAA,CAAA;AAC/C,KAAA,CAAA;IAEA,MAAOY,CAAAA,KAEN,GAFD,SAAOA,KAAAA,GAAAA;QACL,IAAI,CAACZ,QAAQ,GAAG,CAAA,CAAA;AAClB,KAAA,CAAA;IAEA,MAAOa,CAAAA,OAON,GAPD,SAAOA,OAAAA,GAAAA;QACL,IAAI,IAAI,CAACL,MAAM,EAAE;AACf,YAAA,IAAI,CAACT,EAAE,CAACG,aAAa,GAAG,IAAI,CAACD,iBAAiB,CAAA;AAC9C,YAAA,IAAI,CAACF,EAAE,CAACK,aAAa,GAAG,IAAI,CAACD,iBAAiB,CAAA;AAChD,SAAA;QAEA,IAAI,CAACK,MAAM,GAAG,KAAA,CAAA;AAChB,KAAA,CAAA;AAjDmBV,IAAAA,OAAAA,WAAAA,CAAAA;;;;;"}