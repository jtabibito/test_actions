import './constants.js';
import { _ as _async_to_generator, a as _create_class, b as __generator, L as LineVertexBuilder } from '../index-ac53e8dd.js';
import { _ as _inherits } from '../LineMaterial-1723f22c.js';
import { Texture2D } from '@galacean/engine';
import { DashMaterial } from './material/DashMaterial.js';
import { Line } from './Line.js';
import './vertexBuilder/atob.js';
import './material/lineShader.js';
import './material/dashShader.js';

/**
 * Dash Line.
 */ var DashLine = /*#__PURE__*/ function(Line) {
    _inherits(DashLine, Line);
    function DashLine(entity) {
        var _this;
        _this = Line.call(this, entity) || this;
        _this._material = null;
        return _this;
    }
    var _proto = DashLine.prototype;
    _proto._generateData = function _generateData() {
        var _this = this;
        return _async_to_generator(function() {
            return __generator(this, function(_state) {
                switch(_state.label){
                    case 0:
                        return [
                            4,
                            LineVertexBuilder.instance.dashLine(_this._flattenPoints, _this._join, _this._cap, 0, -1)
                        ];
                    case 1:
                        return [
                            2,
                            _state.sent()
                        ];
                }
            });
        })();
    };
    _proto._initMaterial = function _initMaterial() {
        var material = new DashMaterial(this.engine);
        this._renderer.setMaterial(material);
        this._material = material;
    };
    _proto._generateDashTexture = function _generateDashTexture(dash) {
        var pixels = [];
        var length = Math.ceil((dash.x + dash.y) * 10);
        for(var index = 0; index < length; index++){
            if (index < dash.x * 10) {
                pixels.push(255, 255, 255, 255);
            } else {
                pixels.push(255, 255, 255, 0);
            }
        }
        return new Uint8Array(pixels);
    };
    _create_class(DashLine, [
        {
            key: "dash",
            get: /**
   * The dash sequence is a series of on/off lengths in points. e.g. [3, 1] would be 3pt long lines separated by 1pt spaces.
   */ function get() {
                return this._dash;
            },
            set: function set(val) {
                var _this__renderer, _this__renderer1;
                this._dash = val;
                (_this__renderer = this._renderer) == null ? void 0 : _this__renderer.shaderData.setVector2("u_dash", val);
                var texture = new Texture2D(this.engine, 1, Math.ceil((val.x + val.y) * 10));
                texture.setPixelBuffer(this._generateDashTexture(val));
                (_this__renderer1 = this._renderer) == null ? void 0 : _this__renderer1.shaderData.setTexture("u_texture", texture);
            }
        }
    ]);
    return DashLine;
}(Line);

export { DashLine };
//# sourceMappingURL=DashLine.js.map
