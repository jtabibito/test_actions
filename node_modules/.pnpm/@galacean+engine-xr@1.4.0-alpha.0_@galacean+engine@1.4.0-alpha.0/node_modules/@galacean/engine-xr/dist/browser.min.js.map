{"version":3,"file":"browser.min.js","sources":["../../../node_modules/.pnpm/@swc+helpers@0.5.15/node_modules/@swc/helpers/esm/_is_native_reflect_construct.js","../../../node_modules/.pnpm/@swc+helpers@0.5.15/node_modules/@swc/helpers/esm/_set_prototype_of.js","../../../node_modules/.pnpm/@swc+helpers@0.5.15/node_modules/@swc/helpers/esm/_construct.js","../../../node_modules/.pnpm/@swc+helpers@0.5.15/node_modules/@swc/helpers/esm/_create_class.js","../../../node_modules/.pnpm/@swc+helpers@0.5.15/node_modules/@swc/helpers/esm/_inherits.js","../../../node_modules/.pnpm/@swc+helpers@0.5.15/node_modules/@swc/helpers/esm/_instanceof.js","../src/input/XRTrackedInputDevice.ts","../src/session/XRSessionState.ts","../src/input/XRTrackingState.ts","../src/input/XRInputButton.ts","../src/input/XRInputEventType.ts","../src/input/XRTargetRayMode.ts","../src/session/XRSessionMode.ts","../src/feature/XRFeatureType.ts","../src/feature/trackable/XRRequestTrackingState.ts","../src/feature/hitTest/TrackableType.ts","../src/feature/trackable/plane/XRPlaneMode.ts","../src/feature/camera/XRCameraManager.ts","../src/XRPose.ts","../src/input/XRInput.ts","../src/input/XRCamera.ts","../src/input/XRController.ts","../src/input/XRInputManager.ts","../src/session/XRSessionManager.ts","../src/XRManagerExtended.ts","../src/feature/XRFeature.ts","../src/feature/trackable/XRTrackableFeature.ts","../src/feature/trackable/XRTracked.ts","../src/feature/hitTest/XRHitResult.ts","../../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs","../src/feature/trackable/XRRequestTracking.ts","../src/feature/trackable/plane/XRRequestPlane.ts","../src/feature/trackable/plane/XRTrackedPlane.ts","../src/feature/trackable/plane/XRPlaneTracking.ts","../src/feature/hitTest/XRHitTest.ts","../src/feature/trackable/anchor/XRAnchor.ts","../src/feature/trackable/anchor/XRRequestAnchor.ts","../src/feature/trackable/anchor/XRAnchorTracking.ts","../src/feature/trackable/image/XRRequestImage.ts","../src/feature/trackable/image/XRTrackedImage.ts","../src/feature/trackable/image/XRImageTracking.ts","../src/feature/trackable/image/XRReferenceImage.ts","../../../node_modules/.pnpm/@swc+helpers@0.5.15/node_modules/@swc/helpers/esm/_extends.js","../src/loader/XRReferenceImageDecoder.ts","../src/loader/XRReferenceImageLoader.ts"],"sourcesContent":["function _is_native_reflect_construct() {\n    // Since Reflect.construct can't be properly polyfilled, some\n    // implementations (e.g. core-js@2) don't set the correct internal slots.\n    // Those polyfills don't allow us to subclass built-ins, so we need to\n    // use our fallback implementation.\n    try {\n        // If the internal slots aren't set, this throws an error similar to\n        //   TypeError: this is not a Boolean object.\n        var result = !Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function() {}));\n    } catch (_) {}\n    return (_is_native_reflect_construct = function() {\n        return !!result;\n    })();\n}\n\nexport { _is_native_reflect_construct as _ };\n","function _set_prototype_of(o, p) {\n    _set_prototype_of = Object.setPrototypeOf || function setPrototypeOf(o, p) {\n        o.__proto__ = p;\n\n        return o;\n    };\n\n    return _set_prototype_of(o, p);\n}\nexport { _set_prototype_of as _ };\n","import { _ as _is_native_reflect_construct } from \"./_is_native_reflect_construct.js\";\nimport { _ as _set_prototype_of } from \"./_set_prototype_of.js\";\nfunction _construct(Parent, args, Class) {\n    if (_is_native_reflect_construct()) _construct = Reflect.construct;\n    else {\n        _construct = function construct(Parent, args, Class) {\n            var a = [null];\n            a.push.apply(a, args);\n            var Constructor = Function.bind.apply(Parent, a);\n            var instance = new Constructor();\n\n            if (Class) _set_prototype_of(instance, Class.prototype);\n\n            return instance;\n        };\n    }\n\n    return _construct.apply(null, arguments);\n}\nexport { _construct as _ };\n","function _defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n\n        if (\"value\" in descriptor) descriptor.writable = true;\n\n        Object.defineProperty(target, descriptor.key, descriptor);\n    }\n}\nfunction _create_class(Constructor, protoProps, staticProps) {\n    if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) _defineProperties(Constructor, staticProps);\n\n    return Constructor;\n}\nexport { _create_class as _ };\n","import { _ as _set_prototype_of } from \"./_set_prototype_of.js\";\n\nfunction _inherits(subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n        throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } });\n\n    if (superClass) _set_prototype_of(subClass, superClass);\n}\nexport { _inherits as _ };\n","function _instanceof(left, right) {\n    if (right != null && typeof Symbol !== \"undefined\" && right[Symbol.hasInstance]) {\n        return !!right[Symbol.hasInstance](left);\n    } else return left instanceof right;\n}\nexport { _instanceof as _ };\n","/**\n * Enumerates some input devices that can be tracked.(including status, posture and other information)\n */\nexport enum XRTrackedInputDevice {\n  /** Controller */\n  Controller,\n  /** Left controller */\n  LeftController,\n  /** Right controller */\n  RightController,\n  /** Camera */\n  Camera,\n  /** Left camera */\n  LeftCamera,\n  /** Right camera */\n  RightCamera,\n  /** Head */\n  LeftHand,\n  /** Right hand */\n  RightHand\n}\n","/**\n * The state of an XRSession.\n */\nexport enum XRSessionState {\n  /** Not initialized. */\n  None,\n  /** Initializing session. */\n  Initializing,\n  /** Initialized but not started. */\n  Initialized,\n  /** Running. */\n  Running,\n  /** Paused. */\n  Paused\n}\n","/**\n * Enum for XR tracking state.\n */\nexport enum XRTrackingState {\n  /** Not tracking */\n  NotTracking,\n  /** Tracking */\n  Tracking,\n  /** Lost track */\n  TrackingLost\n}\n","/**\n * Enum for XR input button.\n */\nexport enum XRInputButton {\n  /** None */\n  None = 0x0,\n  /** Select */\n  Select = 0x1,\n  /** Select */\n  Trigger = 0x1,\n  /** Squeeze */\n  Squeeze = 0x2,\n  /** TouchPad */\n  TouchPad = 0x4,\n  /** A */\n  AButton = 0x8,\n  /** B */\n  BButton = 0x10\n}\n","export enum XRInputEventType {\n  SelectStart,\n  Select,\n  SelectEnd,\n  SqueezeStart,\n  Squeeze,\n  SqueezeEnd\n}\n","export enum XRTargetRayMode {\n  Gaze,\n  TrackedPointer,\n  Screen\n}\n","/**\n * The type of XR session.\n */\nexport enum XRSessionMode {\n  None,\n  AR,\n  VR\n}\n","export enum XRFeatureType {\n  AnchorTracking,\n  ImageTracking,\n  PlaneTracking,\n  HitTest\n}\n","export enum XRRequestTrackingState {\n  None,\n  Submitted,\n  Resolved,\n  Rejected,\n  Destroyed,\n  WaitingDestroy\n}\n","/**\n * Enum for the types of hit test that can be performed.\n * Note: currently only supports plane.\n */\nexport enum TrackableType {\n  /** Tracked plane. */\n  Plane = 0x1,\n  /** All tracked objects. */\n  All = 0x1\n}\n","/**\n * Enumerates modes of plane in XR.\n */\nexport enum XRPlaneMode {\n  /** None. */\n  None = 0,\n  /** Horizontal */\n  Horizontal = 0b1,\n  /** Vertical */\n  Vertical = 0b10,\n  /** Includes horizontal and vertical. */\n  EveryThing = 0b11\n}\n","import { Camera, CameraClearFlags, CameraType, Matrix } from \"@galacean/engine\";\nimport { XRManagerExtended } from \"../../XRManagerExtended\";\nimport { XRCamera } from \"../../input/XRCamera\";\nimport { XRTrackedInputDevice } from \"../../input/XRTrackedInputDevice\";\nimport { XRSessionState } from \"../../session/XRSessionState\";\n\n/**\n * The manager of XR camera.\n */\nexport class XRCameraManager {\n  /**\n   * The fixed foveation of the camera.\n   */\n  get fixedFoveation(): number {\n    const { _platformSession: platformSession } = this._xrManager.sessionManager;\n    if (platformSession) {\n      return platformSession.getFixedFoveation();\n    } else {\n      throw new Error(\"XR session is not available.\");\n    }\n  }\n\n  set fixedFoveation(value: number) {\n    const { _platformSession: platformSession } = this._xrManager.sessionManager;\n    if (platformSession) {\n      platformSession.setFixedFoveation(value);\n    } else {\n      throw new Error(\"XR session is not available.\");\n    }\n  }\n\n  /**\n   * @internal\n   */\n  constructor(private _xrManager: XRManagerExtended) {}\n\n  /**\n   * Attach the camera to the specified input type(Camera, LeftCamera or RightCamera).\n   * The camera entity need to be moved to the XROrigin entity.\n   * @param type - The input type\n   * @param camera - The camera to be attached\n   */\n  attachCamera(\n    type: XRTrackedInputDevice.Camera | XRTrackedInputDevice.LeftCamera | XRTrackedInputDevice.RightCamera,\n    camera: Camera\n  ): void {\n    const xrCamera = this._xrManager.inputManager.getTrackedDevice<XRCamera>(type);\n    const preCamera = xrCamera._camera;\n    if (preCamera !== camera) {\n      // @ts-ignore\n      preCamera && (preCamera._cameraType = CameraType.Normal);\n      switch (type) {\n        case XRTrackedInputDevice.Camera:\n          // @ts-ignore\n          camera._cameraType = CameraType.XRCenterCamera;\n          break;\n        case XRTrackedInputDevice.LeftCamera:\n          // @ts-ignore\n          camera._cameraType = CameraType.XRLeftCamera;\n          break;\n        case XRTrackedInputDevice.RightCamera:\n          // @ts-ignore\n          camera._cameraType = CameraType.XRRightCamera;\n          break;\n        default:\n          break;\n      }\n      xrCamera._camera = camera;\n    }\n  }\n\n  /**\n   * Detach the camera from the specified input type.\n   * @param type - The input type\n   * @returns The camera that was detached\n   */\n  detachCamera(\n    type: XRTrackedInputDevice.Camera | XRTrackedInputDevice.LeftCamera | XRTrackedInputDevice.RightCamera\n  ): Camera {\n    const xrCamera = this._xrManager.inputManager.getTrackedDevice<XRCamera>(type);\n    const preCamera = xrCamera._camera;\n    // @ts-ignore\n    preCamera && (preCamera._cameraType = CameraType.Normal);\n    xrCamera._camera = null;\n    return preCamera;\n  }\n\n  /**\n   * @internal\n   */\n  _onSessionStart(): void {}\n\n  /**\n   * @internal\n   */\n  _onUpdate(): void {\n    const { _cameras: cameras } = this._xrManager.inputManager;\n    for (let i = 0, n = cameras.length; i < n; i++) {\n      const cameraDevice = cameras[i];\n      const { _camera: camera } = cameraDevice;\n      if (!camera) continue;\n      // sync position and rotation\n      const { transform } = camera.entity;\n      const { pose } = cameraDevice;\n      transform.position = pose.position;\n      transform.rotationQuaternion = pose.rotation;\n      // sync viewport\n      const { viewport } = camera;\n      const { x, y, width, height } = cameraDevice.viewport;\n      if (!(x === viewport.x && y === viewport.y && width === viewport.z && height === viewport.w)) {\n        camera.viewport = viewport.set(x, y, width, height);\n      }\n      // sync project matrix\n      if (!Matrix.equals(camera.projectionMatrix, cameraDevice.projectionMatrix)) {\n        camera.projectionMatrix = cameraDevice.projectionMatrix;\n      }\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _onSessionExit(): void {}\n\n  /**\n   * @internal\n   */\n  _getIgnoreClearFlags(cameraType: CameraType): CameraClearFlags {\n    if (cameraType === CameraType.XRCenterCamera) {\n      if (this._xrManager.sessionManager.state === XRSessionState.Running) {\n        return CameraClearFlags.Color;\n      } else {\n        return CameraClearFlags.None;\n      }\n    } else {\n      return CameraClearFlags.None;\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _onDestroy(): void {}\n}\n","import { Matrix, Quaternion, Vector3 } from \"@galacean/engine\";\nimport { IXRPose } from \"@galacean/engine-design\";\n\n/**\n * Data for describing pose in the XR space.\n */\nexport class XRPose implements IXRPose {\n  /** The position of the pose in XR space. */\n  position: Vector3 = new Vector3();\n  /** The rotation of the pose in XR space. */\n  rotation: Quaternion = new Quaternion();\n  /** The matrix of the pose in XR space. */\n  matrix: Matrix = new Matrix();\n  /** The inverse matrix of the pose in XR space. */\n  inverseMatrix: Matrix = new Matrix();\n}\n","import { IXRInput } from \"@galacean/engine-design\";\nimport { XRTrackedInputDevice } from \"./XRTrackedInputDevice\";\nimport { XRTrackingState } from \"./XRTrackingState\";\n\nexport class XRInput implements IXRInput {\n  /** The tracking state of xr input. */\n  trackingState: XRTrackingState = XRTrackingState.NotTracking;\n\n  /**\n   * @internal\n   */\n  constructor(public type: XRTrackedInputDevice) {}\n}\n","import { IXRCamera } from \"@galacean/engine-design\";\nimport { Matrix, Rect, Camera } from \"@galacean/engine\";\nimport { XRPose } from \"../XRPose\";\nimport { XRInput } from \"./XRInput\";\n\n/**\n * The XR camera.\n */\nexport class XRCamera extends XRInput implements IXRCamera {\n  /** The pose of the camera in XR space. */\n  pose: XRPose = new XRPose();\n  /** The viewport of the camera. */\n  viewport: Rect = new Rect();\n  /** The projection matrix of the camera. */\n  projectionMatrix: Matrix = new Matrix();\n\n  /** @internal */\n  _camera: Camera;\n}\n","import { IXRController } from \"@galacean/engine-design\";\nimport { XRPose } from \"../XRPose\";\nimport { XRInput } from \"./XRInput\";\nimport { XRInputButton } from \"./XRInputButton\";\n\n/**\n * The XR controller.\n */\nexport class XRController extends XRInput implements IXRController {\n  /** The grip space pose of the controller in XR space. */\n  gripPose: XRPose = new XRPose();\n  /** The target ray space pose of the controller in XR space. */\n  targetRayPose: XRPose = new XRPose();\n  /** The currently pressed buttons of this controller. */\n  pressedButtons: XRInputButton = XRInputButton.None;\n  /** Record button lifted. */\n  down: XRInputButton = XRInputButton.None;\n  /** Record button pressed. */\n  up: XRInputButton = XRInputButton.None;\n\n  /**\n   *\n   * Returns whether the button is pressed.\n   * @param button - The button to check\n   * @returns Whether the button is pressed\n   */\n  isButtonDown(button: XRInputButton): boolean {\n    return (this.down & button) !== 0;\n  }\n\n  /**\n   * Returns whether the button is lifted.\n   * @param button - The button to check\n   * @returns Whether the button is lifted\n   */\n  isButtonUp(button: XRInputButton): boolean {\n    return (this.up & button) !== 0;\n  }\n\n  /**\n   * Returns whether the button is held down.\n   * @param button - The button to check\n   * @returns Whether the button is held down\n   */\n  isButtonHeldDown(button: XRInputButton): boolean {\n    return (this.pressedButtons & button) !== 0;\n  }\n}\n","import { Engine, SafeLoopArray } from \"@galacean/engine\";\nimport { IXRInputEvent } from \"@galacean/engine-design\";\nimport { IXRListener, XRManagerExtended } from \"../XRManagerExtended\";\nimport { XRCamera } from \"./XRCamera\";\nimport { XRController } from \"./XRController\";\nimport { XRInput } from \"./XRInput\";\nimport { XRInputButton } from \"./XRInputButton\";\nimport { XRInputEventType } from \"./XRInputEventType\";\nimport { XRTargetRayMode } from \"./XRTargetRayMode\";\nimport { XRTrackedInputDevice } from \"./XRTrackedInputDevice\";\nimport { XRTrackingState } from \"./XRTrackingState\";\n\n/**\n * The manager of XR input.\n */\nexport class XRInputManager {\n  /** @internal */\n  _cameras: XRCamera[] = [];\n  /** @internal */\n  _controllers: XRController[] = [];\n\n  private _added: XRInput[] = [];\n  private _removed: XRInput[] = [];\n  private _trackedDevices: XRInput[] = [];\n  private _statusSnapshot: XRTrackingState[] = [];\n  private _listeners: SafeLoopArray<IXRListener> = new SafeLoopArray<IXRListener>();\n\n  /**\n   * @internal\n   */\n  constructor(\n    private _xrManager: XRManagerExtended,\n    private _engine: Engine\n  ) {\n    const { _trackedDevices: trackedDevices, _controllers: controllers, _cameras: cameras } = this;\n    for (let i = 0; i < 6; i++) {\n      switch (i) {\n        case XRTrackedInputDevice.Camera:\n        case XRTrackedInputDevice.LeftCamera:\n        case XRTrackedInputDevice.RightCamera:\n          cameras.push((trackedDevices[i] = new XRCamera(i)));\n          break;\n        case XRTrackedInputDevice.Controller:\n        case XRTrackedInputDevice.LeftController:\n        case XRTrackedInputDevice.RightController:\n          controllers.push((trackedDevices[i] = new XRController(i)));\n          break;\n        default:\n          break;\n      }\n    }\n    this._statusSnapshot.fill(XRTrackingState.NotTracking, 0, trackedDevices.length);\n  }\n\n  /**\n   * Returns the tracked device instance.\n   * @param type - The tracked input device type\n   * @returns The input instance\n   */\n  getTrackedDevice<T extends XRInput>(type: XRTrackedInputDevice): T {\n    return <T>this._trackedDevices[type];\n  }\n\n  /**\n   * Add a listener for tracked device changes.\n   * @param listener - The listener to add\n   */\n  addTrackedDeviceChangedListener(listener: (added: readonly XRInput[], removed: readonly XRInput[]) => void): void {\n    this._listeners.push({ fn: listener });\n  }\n\n  /**\n   * Remove a listener of tracked device changes.\n   * @param listener - The listener to remove\n   */\n  removeTrackedDeviceChangedListener(listener: (added: readonly XRInput[], removed: readonly XRInput[]) => void): void {\n    this._listeners.findAndRemove((value) => (value.fn === listener ? (value.destroyed = true) : false));\n  }\n\n  /**\n   * @internal\n   */\n  _onUpdate(): void {\n    const { _added: added, _removed: removed, _statusSnapshot: statusSnapshot } = this;\n    const { _trackedDevices: trackedDevices, _controllers: controllers } = this;\n    // Reset data\n    added.length = removed.length = 0;\n    for (let i = 0, n = controllers.length; i < n; i++) {\n      const controller = controllers[i];\n      controller.down = controller.up = 0;\n    }\n    // Handle events and update tracked devices\n    const { _platformSession: platformSession } = this._xrManager.sessionManager;\n    const { events: platformEvents } = platformSession;\n    for (let i = 0, n = platformEvents.length; i < n; i++) {\n      this._handleEvent(platformEvents[i]);\n    }\n    platformSession.resetEvents();\n    platformSession.frame.updateInputs(trackedDevices);\n    for (let i = 0, n = trackedDevices.length; i < n; i++) {\n      const input = trackedDevices[i];\n      if (!input) continue;\n      const nowState = input.trackingState;\n      if (statusSnapshot[i] === XRTrackingState.Tracking) {\n        if (nowState !== XRTrackingState.Tracking) {\n          removed.push(input);\n        }\n      } else {\n        if (nowState === XRTrackingState.Tracking) {\n          added.push(input);\n        }\n      }\n      statusSnapshot[i] = nowState;\n    }\n    // Dispatch change event\n    if (added.length > 0 || removed.length > 0) {\n      const listeners = this._listeners.getLoopArray();\n      for (let i = 0, n = listeners.length; i < n; i++) {\n        const listener = listeners[i];\n        !listener.destroyed && listener.fn(added, removed);\n      }\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _onDestroy(): void {\n    this._listeners.findAndRemove((value) => (value.destroyed = true));\n  }\n\n  private _handleEvent(event: IXRInputEvent): void {\n    const input = <XRController>this._trackedDevices[event.input];\n    switch (event.targetRayMode) {\n      case XRTargetRayMode.TrackedPointer:\n        switch (event.type) {\n          case XRInputEventType.SelectStart:\n            input.down |= XRInputButton.Select;\n            input.pressedButtons |= XRInputButton.Select;\n            break;\n          case XRInputEventType.SelectEnd:\n            input.up |= XRInputButton.Select;\n            input.pressedButtons &= ~XRInputButton.Select;\n            break;\n          case XRInputEventType.SqueezeStart:\n            input.down |= XRInputButton.Squeeze;\n            input.pressedButtons |= XRInputButton.Squeeze;\n            break;\n          case XRInputEventType.SqueezeEnd:\n            input.up |= XRInputButton.Squeeze;\n            input.pressedButtons &= ~XRInputButton.Squeeze;\n            break;\n          default:\n            break;\n        }\n        break;\n      case XRTargetRayMode.Screen:\n        const { _engine: engine } = this;\n        // @ts-ignore\n        const target: EventTarget = engine.inputManager._pointerManager._target;\n        // @ts-ignore\n        const canvas = <HTMLCanvasElement>engine.canvas._webCanvas;\n        const { clientWidth, clientHeight } = canvas;\n        const clientX = clientWidth * (event.x + 1) * 0.5;\n        const clientY = clientHeight * (event.y + 1) * 0.5;\n        // @ts-ignore\n        switch (event.type) {\n          case XRInputEventType.SelectStart:\n            target.dispatchEvent(this._makeUpPointerEvent(\"pointerdown\", event.id, clientX, clientY));\n            break;\n          case XRInputEventType.Select:\n            target.dispatchEvent(this._makeUpPointerEvent(\"pointermove\", event.id, clientX, clientY));\n            break;\n          case XRInputEventType.SelectEnd:\n            target.dispatchEvent(this._makeUpPointerEvent(\"pointerup\", event.id, clientX, clientY));\n            target.dispatchEvent(this._makeUpPointerEvent(\"pointerleave\", event.id, clientX, clientY));\n            break;\n          default:\n            break;\n        }\n        break;\n      default:\n        break;\n    }\n  }\n\n  private _makeUpPointerEvent(type: string, pointerId: number, clientX: number, clientY: number): PointerEvent {\n    const eventInitDict: PointerEventInit = {\n      pointerId,\n      clientX,\n      clientY\n    };\n    switch (type) {\n      case \"pointerdown\":\n        eventInitDict.button = 0;\n        eventInitDict.buttons = 1;\n        break;\n      case \"pointermove\":\n        eventInitDict.button = -1;\n        eventInitDict.buttons = 1;\n        break;\n      case \"pointerup\":\n        eventInitDict.button = 0;\n        eventInitDict.buttons = 0;\n        break;\n      case \"pointerleave\":\n        eventInitDict.button = 0;\n        eventInitDict.buttons = 0;\n        break;\n      default:\n        break;\n    }\n    return new PointerEvent(type, eventInitDict);\n  }\n}\n","import { Engine, SafeLoopArray } from \"@galacean/engine\";\nimport { IHardwareRenderer, IXRSession } from \"@galacean/engine-design\";\nimport { IXRListener, XRManagerExtended } from \"../XRManagerExtended\";\nimport { XRFeature } from \"../feature/XRFeature\";\nimport { XRSessionMode } from \"./XRSessionMode\";\nimport { XRSessionState } from \"./XRSessionState\";\n\n/**\n * XRSessionManager manages the life cycle of XR sessions.\n */\nexport class XRSessionManager {\n  /** @internal */\n  _platformSession: IXRSession;\n\n  private _mode: XRSessionMode = XRSessionMode.None;\n  private _state: XRSessionState = XRSessionState.None;\n  private _rhi: IHardwareRenderer;\n  private _raf: (callback: FrameRequestCallback) => number;\n  private _caf: (id: number) => void;\n  private _listeners: SafeLoopArray<IXRListener> = new SafeLoopArray<IXRListener>();\n\n  /**\n   * The current session mode( AR or VR ).\n   */\n  get mode(): XRSessionMode {\n    return this._mode;\n  }\n\n  /**\n   * Return the current session state.\n   */\n  get state(): XRSessionState {\n    return this._state;\n  }\n\n  /**\n   * Return a list of supported frame rates.(only available in-session)\n   */\n  get supportedFrameRate(): Float32Array {\n    return this._platformSession.supportedFrameRates;\n  }\n\n  /**\n   * Return the current frame rate as reported by the device.\n   */\n  get frameRate(): number {\n    return this._platformSession.frameRate;\n  }\n\n  /**\n   * @internal\n   */\n  constructor(\n    private _xrManager: XRManagerExtended,\n    private _engine: Engine\n  ) {\n    // @ts-ignore\n    this._rhi = _engine._hardwareRenderer;\n    this._raf = requestAnimationFrame.bind(window);\n    this._caf = cancelAnimationFrame.bind(window);\n    this._onSessionExit = this._onSessionExit.bind(this);\n  }\n\n  /**\n   * Check if the specified mode is supported.\n   * @param mode - The mode to check\n   * @returns A promise that resolves if the mode is supported, otherwise rejects\n   */\n  isSupportedMode(mode: XRSessionMode): Promise<void> {\n    return this._xrManager._platformDevice.isSupportedSessionMode(mode);\n  }\n\n  /**\n   * Run the session.\n   */\n  run(): void {\n    const { _platformSession: platformSession, _engine: engine } = this;\n    if (!platformSession) {\n      throw new Error(\"Without session to run.\");\n    }\n    platformSession.start();\n    this._setState(XRSessionState.Running);\n    this._xrManager._onSessionStart();\n    if (!engine.isPaused) {\n      engine.pause();\n      engine.resume();\n    }\n  }\n\n  /**\n   * Stop the session.\n   */\n  stop(): void {\n    const { _platformSession: platformSession, _engine: engine, _rhi: rhi } = this;\n    if (!platformSession) {\n      throw new Error(\"Without session to stop.\");\n    }\n    if (this._state !== XRSessionState.Running) {\n      throw new Error(\"Session is not running.\");\n    }\n    rhi._mainFrameBuffer = null;\n    rhi._mainFrameWidth = rhi._mainFrameHeight = 0;\n    platformSession.stop();\n    this._setState(XRSessionState.Paused);\n    this._xrManager._onSessionStop();\n    if (!engine.isPaused) {\n      engine.pause();\n      engine.resume();\n    }\n  }\n\n  /**\n   * Add a listening function for session state changes.\n   * @param listener - The listening function\n   */\n  addStateChangedListener(listener: (state: XRSessionState) => void): void {\n    this._listeners.push({ fn: listener });\n  }\n\n  /**\n   * Remove a listening function of session state changes.\n   * @param listener - The listening function\n   */\n  removeStateChangedListener(listener: (state: XRSessionState) => void): void {\n    this._listeners.findAndRemove((value) => (value.fn === listener ? (value.destroyed = true) : false));\n  }\n\n  /**\n   * @internal\n   */\n  _setState(value: XRSessionState) {\n    this._state = value;\n    const listeners = this._listeners.getLoopArray();\n    for (let i = 0, n = listeners.length; i < n; i++) {\n      const listener = listeners[i];\n      !listener.destroyed && listener.fn(value);\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _initialize(mode: XRSessionMode, features: XRFeature[]): Promise<void> {\n    return new Promise((resolve, reject) => {\n      const { _xrManager: xrManager } = this;\n      // Initialize all features\n      const platformFeatures = [];\n      for (let i = 0, n = features.length; i < n; i++) {\n        const { _platformFeature: platformFeature } = features[i];\n        platformFeature && platformFeatures.push(platformFeature);\n      }\n      xrManager._platformDevice\n        .requestSession(this._rhi, mode, platformFeatures)\n        .then((platformSession: IXRSession) => {\n          this._mode = mode;\n          this._platformSession = platformSession;\n          this._setState(XRSessionState.Initialized);\n          platformSession.setSessionExitCallBack(this._onSessionExit);\n          platformSession.addEventListener();\n          xrManager._onSessionInit();\n          resolve();\n        }, reject);\n    });\n  }\n\n  /**\n   * @internal\n   */\n  _onUpdate() {\n    const { _rhi: rhi, _platformSession: platformSession } = this;\n    rhi._mainFrameBuffer = platformSession.framebuffer;\n    rhi._mainFrameWidth = platformSession.framebufferWidth;\n    rhi._mainFrameHeight = platformSession.framebufferHeight;\n  }\n\n  /**\n   * @internal\n   */\n  _getRequestAnimationFrame(): (callback: FrameRequestCallback) => number {\n    if (this._state === XRSessionState.Running) {\n      return this._platformSession.requestAnimationFrame;\n    } else {\n      return this._raf;\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _getCancelAnimationFrame(): (id: number) => void {\n    if (this._state === XRSessionState.Running) {\n      return this._platformSession.cancelAnimationFrame;\n    } else {\n      return this._caf;\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _exit(): Promise<void> {\n    const { _platformSession: platformSession } = this;\n    if (!platformSession) {\n      return Promise.reject(\"Without session to stop.\");\n    }\n    return platformSession.end();\n  }\n\n  private _onSessionExit() {\n    const { _rhi: rhi, _platformSession: platformSession, _engine: engine } = this;\n    rhi._mainFrameBuffer = null;\n    rhi._mainFrameWidth = rhi._mainFrameHeight = 0;\n    platformSession.removeEventListener();\n    this._platformSession = null;\n    this._setState(XRSessionState.None);\n    this._xrManager._onSessionExit();\n    if (!engine.isPaused) {\n      engine.pause();\n      engine.resume();\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _onDestroy(): void {\n    this._listeners.findAndRemove((value) => (value.destroyed = true));\n    this._raf = this._caf = null;\n  }\n}\n","import { CameraClearFlags, CameraType, Engine, Entity, XRManager } from \"@galacean/engine\";\nimport { IXRDevice } from \"@galacean/engine-design\";\nimport { XRFeature } from \"./feature/XRFeature\";\nimport { XRFeatureType } from \"./feature/XRFeatureType\";\nimport { XRCameraManager } from \"./feature/camera/XRCameraManager\";\nimport { XRInputManager } from \"./input/XRInputManager\";\nimport { XRSessionManager } from \"./session/XRSessionManager\";\nimport { XRSessionMode } from \"./session/XRSessionMode\";\nimport { XRSessionState } from \"./session/XRSessionState\";\n/**\n * @internal\n */\nexport class XRManagerExtended extends XRManager {\n  /** @internal */\n  static _featureMap: Map<TFeatureConstructor<XRFeature>, XRFeatureType> = new Map();\n\n  override inputManager: XRInputManager;\n  override sessionManager: XRSessionManager;\n  override cameraManager: XRCameraManager;\n\n  /** @internal */\n  _platformDevice: IXRDevice;\n\n  private _features: XRFeature[];\n  private _origin: Entity;\n\n  override get features(): XRFeature[] {\n    return this._features;\n  }\n\n  override get origin(): Entity {\n    return this._origin;\n  }\n\n  override set origin(value: Entity) {\n    if (this.sessionManager._platformSession) {\n      throw new Error(\"Cannot set origin when the session is initialized.\");\n    }\n    this._origin = value;\n  }\n\n  override isSupportedFeature<T extends XRFeature>(feature: TFeatureConstructor<T>): boolean {\n    return this._platformDevice.isSupportedFeature(XRManagerExtended._featureMap.get(feature));\n  }\n\n  override addFeature<T extends new (xrManager: XRManagerExtended, ...args: any[]) => XRFeature>(\n    type: T,\n    ...args: TFeatureConstructorArguments<T>\n  ): InstanceType<T> | null {\n    if (this.sessionManager._platformSession) {\n      throw new Error(\"Cannot add feature when the session is initialized.\");\n    }\n    if (!this._platformDevice.isSupportedFeature(XRManagerExtended._featureMap.get(type))) {\n      throw new Error(\"The feature is not supported\");\n    }\n    const { features } = this;\n    for (let i = 0, n = features.length; i < n; i++) {\n      if (features[i] instanceof type) throw new Error(\"The feature has been added\");\n    }\n    const feature = new type(this, ...args) as InstanceType<T>;\n    features.push(feature);\n    return feature;\n  }\n\n  override getFeature<T extends XRFeature>(type: TFeatureConstructor<T>): T | null {\n    const { features } = this;\n    for (let i = 0, n = features.length; i < n; i++) {\n      const feature = features[i];\n      if (feature instanceof type) {\n        return feature;\n      }\n    }\n  }\n\n  override enterXR(sessionMode: XRSessionMode, autoRun: boolean = true): Promise<void> {\n    const { sessionManager } = this;\n    if (sessionManager._platformSession) {\n      throw new Error(\"Please exit XR immersive mode first.\");\n    }\n    if (!this._origin) {\n      throw new Error(\"Please set origin before enter XR.\");\n    }\n    return new Promise((resolve, reject) => {\n      // 1. Check if this xr mode is supported\n      sessionManager.isSupportedMode(sessionMode).then(() => {\n        sessionManager._setState(XRSessionState.Initializing);\n        // 2. Initialize session\n        sessionManager._initialize(sessionMode, this.features).then(() => {\n          autoRun && sessionManager.run();\n          resolve();\n        }, reject);\n      }, reject);\n    });\n  }\n\n  override exitXR(): Promise<void> {\n    return new Promise((resolve, reject) => {\n      this.sessionManager._exit().then(() => {\n        resolve();\n      }, reject);\n    });\n  }\n\n  override _initialize(engine: Engine, xrDevice: IXRDevice): void {\n    this._features = [];\n    this._platformDevice = xrDevice;\n    this.sessionManager = new XRSessionManager(this, engine);\n    this.inputManager = new XRInputManager(this, engine);\n    this.cameraManager = new XRCameraManager(this);\n  }\n\n  override _update(): void {\n    const { sessionManager } = this;\n    if (sessionManager.state !== XRSessionState.Running) return;\n    sessionManager._onUpdate();\n    this.inputManager._onUpdate();\n    this.cameraManager._onUpdate();\n    const { features } = this;\n    for (let i = 0, n = features.length; i < n; i++) {\n      const feature = features[i];\n      feature.enabled && feature._onUpdate();\n    }\n  }\n\n  override _destroy(): void {\n    if (this.sessionManager._platformSession) {\n      this.exitXR().then(() => {\n        this.sessionManager._onDestroy();\n        this.inputManager._onDestroy();\n        this.cameraManager._onDestroy();\n      });\n    } else {\n      this.sessionManager._onDestroy();\n      this.inputManager._onDestroy();\n      this.cameraManager._onDestroy();\n    }\n  }\n\n  override _getRequestAnimationFrame(): (callback: FrameRequestCallback) => number {\n    return this.sessionManager._getRequestAnimationFrame();\n  }\n\n  override _getCancelAnimationFrame(): (id: number) => void {\n    return this.sessionManager._getCancelAnimationFrame();\n  }\n\n  override _getCameraIgnoreClearFlags(type: CameraType): CameraClearFlags {\n    return this.cameraManager._getIgnoreClearFlags(type);\n  }\n\n  /**\n   * @internal\n   */\n  _onSessionStop(): void {\n    const { features } = this;\n    for (let i = 0, n = features.length; i < n; i++) {\n      const feature = features[i];\n      feature.enabled && feature._onSessionStop();\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _onSessionInit(): void {\n    const { features } = this;\n    for (let i = 0, n = features.length; i < n; i++) {\n      const feature = features[i];\n      feature.enabled && feature._onSessionInit();\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _onSessionStart(): void {\n    this.cameraManager._onSessionStart();\n    const { features } = this;\n    for (let i = 0, n = features.length; i < n; i++) {\n      const feature = features[i];\n      feature.enabled && feature._onSessionStart();\n    }\n  }\n\n  /**\n   * @internal\n   */\n  _onSessionExit(): void {\n    this.cameraManager._onSessionExit();\n    const { features } = this;\n    for (let i = 0, n = features.length; i < n; i++) {\n      const feature = features[i];\n      feature.enabled && feature._onSessionExit();\n      feature._onDestroy();\n    }\n    features.length = 0;\n  }\n}\n\n/**\n * @internal\n */\nexport function registerXRFeature<T extends XRFeature>(type: XRFeatureType): (feature: TFeatureConstructor<T>) => void {\n  return (feature: TFeatureConstructor<T>) => {\n    XRManagerExtended._featureMap.set(feature, type);\n  };\n}\n\nexport interface IXRListener {\n  fn: (...args: any[]) => any;\n  destroyed?: boolean;\n}\n\ntype TFeatureConstructor<T extends XRFeature> = new (xrManager: XRManagerExtended, ...args: any[]) => T;\n\ntype TFeatureConstructorArguments<T extends new (xrManager: XRManagerExtended, ...args: any[]) => XRFeature> =\n  T extends new (xrManager: XRManagerExtended, ...args: infer P) => XRFeature ? P : never;\n\ndeclare module \"@galacean/engine\" {\n  interface XRManager {\n    /** Input manager for XR. */\n    inputManager: XRInputManager;\n    /** Session manager for XR. */\n    sessionManager: XRSessionManager;\n    /** Camera manager for XR. */\n    cameraManager: XRCameraManager;\n\n    /** Initialized features. */\n    get features(): XRFeature[];\n\n    /**\n     * The current origin of XR space.\n     * @remarks The connection point between the virtual world and the real world ( XR Space )\n     */\n    get origin(): Entity;\n    set origin(value: Entity);\n\n    /**\n     * Check if the specified feature is supported.\n     * @param type - The type of the feature\n     * @returns If the feature is supported\n     */\n    isSupportedFeature<T extends XRFeature>(feature: TFeatureConstructor<T>): boolean;\n\n    /**\n     * Add feature based on the xr feature type.\n     * @param type - The type of the feature\n     * @param args - The constructor params of the feature\n     * @returns The feature which has been added\n     */\n    addFeature<T extends new (xrManager: XRManagerExtended, ...args: any[]) => XRFeature>(\n      type: T,\n      ...args: TFeatureConstructorArguments<T>\n    ): InstanceType<T> | null;\n\n    /**\n     * Get feature which match the type.\n     * @param type - The type of the feature\n     * @returns\tThe feature which match type\n     */\n    getFeature<T extends XRFeature>(type: TFeatureConstructor<T>): T | null;\n    /**\n     * Enter XR immersive mode, when you call this method, it will initialize and display the XR virtual world.\n     * @param sessionMode - The mode of the session\n     * @param autoRun - Whether to automatically run the session, when `autoRun` is set to true, xr will start working immediately after initialization. Otherwise, you need to call `sessionManager.run` later to work.\n     * @returns A promise that resolves if the XR virtual world is entered, otherwise rejects\n     */\n    enterXR(sessionMode: XRSessionMode, autoRun?: boolean): Promise<void>;\n    /**\n     * Exit XR immersive mode, when you call this method, it will destroy the XR virtual world.\n     * @returns A promise that resolves if the XR virtual world is destroyed, otherwise rejects\n     */\n    exitXR(): Promise<void>;\n\n    /**\n     * @internal\n     */\n    _initialize(engine: Engine, xrDevice: IXRDevice): void;\n\n    /**\n     * @internal\n     */\n    _getRequestAnimationFrame(): (callback: FrameRequestCallback) => number;\n\n    /**\n     * @internal\n     */\n    _getCancelAnimationFrame(): (id: number) => void;\n\n    /**\n     * @internal\n     */\n    _getCameraIgnoreClearFlags(type: CameraType): CameraClearFlags;\n\n    /**\n     * @internal\n     */\n    _update(): void;\n\n    /**\n     * @internal\n     */\n    _destroy(): void;\n  }\n}\n\n// 实现混入的函数\nfunction ApplyMixins(derivedCtor: any, baseCtors: any[]): void {\n  baseCtors.forEach((baseCtor) => {\n    Object.getOwnPropertyNames(baseCtor.prototype).forEach((name) => {\n      Object.defineProperty(\n        derivedCtor.prototype,\n        name,\n        Object.getOwnPropertyDescriptor(baseCtor.prototype, name) || Object.create(null)\n      );\n    });\n  });\n}\n\nApplyMixins(XRManager, [XRManagerExtended]);\n","import { IXRPlatformFeature } from \"@galacean/engine-design\";\nimport { XRManagerExtended } from \"../XRManagerExtended\";\nimport { XRFeatureType } from \"./XRFeatureType\";\n\n/**\n * The base class of XR feature manager.\n */\nexport abstract class XRFeature<T extends IXRPlatformFeature = IXRPlatformFeature> {\n  /** @internal */\n  _platformFeature: T;\n  protected _enabled: boolean = true;\n\n  /**\n   * Returns whether the feature is enabled.\n   */\n  get enabled(): boolean {\n    return this._enabled;\n  }\n\n  set enabled(value: boolean) {\n    if (this.enabled !== value) {\n      this._enabled = value;\n      value ? this._onEnable() : this._onDisable();\n    }\n  }\n\n  /**\n   * @internal\n   */\n  constructor(\n    protected _xrManager: XRManagerExtended,\n    protected _type: XRFeatureType,\n    ...args: any[]\n  ) {\n    this._platformFeature = <T>_xrManager._platformDevice.createPlatformFeature(_type, ...args);\n    this._onEnable();\n  }\n\n  /**\n   * @internal\n   */\n  _onEnable(): void {}\n\n  /**\n   * @internal\n   */\n  _onDisable(): void {}\n\n  /**\n   * @internal\n   */\n  _onUpdate(): void {}\n\n  /**\n   * @internal\n   */\n  _onSessionInit(): void {}\n\n  /**\n   * @internal\n   */\n  _onSessionStart(): void {}\n\n  /**\n   * @internal\n   */\n  _onSessionStop(): void {}\n\n  /**\n   * @internal\n   */\n  _onSessionExit(): void {}\n\n  /**\n   * @internal\n   */\n  _onDestroy(): void {}\n}\n","import { SafeLoopArray } from \"@galacean/engine\";\nimport { IXRTrackablePlatformFeature } from \"@galacean/engine-design\";\nimport { IXRListener } from \"../../XRManagerExtended\";\nimport { XRTrackingState } from \"../../input/XRTrackingState\";\nimport { XRFeature } from \"../XRFeature\";\nimport { XRFeatureType } from \"../XRFeatureType\";\nimport { XRRequestTracking } from \"./XRRequestTracking\";\nimport { XRRequestTrackingState } from \"./XRRequestTrackingState\";\nimport { XRTracked } from \"./XRTracked\";\n\n/**\n * The base class of XR trackable manager.\n */\nexport abstract class XRTrackableFeature<\n  T extends XRTracked = XRTracked,\n  K extends XRRequestTracking<T> = XRRequestTracking<T>\n> extends XRFeature<IXRTrackablePlatformFeature<T, K>> {\n  protected static _uuid = 0;\n\n  protected _requestTrackings: K[] = [];\n  protected _tracked: T[] = [];\n  protected _added: T[] = [];\n  protected _updated: T[] = [];\n  protected _removed: T[] = [];\n  protected _statusSnapshot: Record<number, XRTrackingState> = {};\n  private _listeners: SafeLoopArray<IXRListener> = new SafeLoopArray<IXRListener>();\n\n  /**\n   * Add a listening function for tracked object changes.\n   * @param listener - The listening function\n   */\n  addChangedListener(listener: (added: readonly T[], updated: readonly T[], removed: readonly T[]) => void): void {\n    this._listeners.push({ fn: listener });\n  }\n\n  /**\n   * Remove a listening function of tracked object changes.\n   * @param listener - The listening function\n   */\n  removeChangedListener(listener: (added: readonly T[], updated: readonly T[], removed: readonly T[]) => void): void {\n    this._listeners.findAndRemove((value) => (value.fn === listener ? (value.destroyed = true) : false));\n  }\n\n  override _onUpdate(): void {\n    const { _platformSession: platformSession } = this._xrManager.sessionManager;\n    const { frame: platformFrame } = platformSession;\n    const {\n      _platformFeature: platformFeature,\n      _requestTrackings: requestTrackings,\n      _statusSnapshot: statusSnapshot,\n      _tracked: allTracked,\n      _added: added,\n      _updated: updated,\n      _removed: removed\n    } = this;\n    if (!platformFrame || !requestTrackings.length) {\n      return;\n    }\n    if (!platformFeature.checkAvailable(platformSession, platformFrame, requestTrackings)) {\n      return;\n    }\n    added.length = updated.length = removed.length = 0;\n    platformFeature.getTrackedResult(platformSession, platformFrame, requestTrackings, this._generateTracked);\n    for (let i = 0, n = requestTrackings.length; i < n; i++) {\n      const requestTracking = requestTrackings[i];\n      switch (requestTracking.state) {\n        case XRRequestTrackingState.Destroyed:\n          const destroyedTracked = requestTracking.tracked;\n          for (let j = 0, n = destroyedTracked.length; j < n; j++) {\n            const tracked = destroyedTracked[j];\n            const trackId = tracked.id;\n            if (statusSnapshot[trackId] === XRTrackingState.Tracking) {\n              removed.push(tracked);\n              allTracked.splice(allTracked.indexOf(tracked), 1);\n            }\n            statusSnapshot[trackId] = XRTrackingState.NotTracking;\n          }\n          break;\n        case XRRequestTrackingState.Resolved:\n          const { tracked } = requestTracking;\n          for (let j = 0, n = tracked.length; j < n; j++) {\n            const trackedObject = tracked[j];\n            const trackId = trackedObject.id;\n            if (trackedObject.state === XRTrackingState.Tracking) {\n              if (statusSnapshot[trackId] === XRTrackingState.Tracking) {\n                updated.push(trackedObject);\n              } else {\n                added.push(trackedObject);\n                statusSnapshot[trackId] = XRTrackingState.Tracking;\n                allTracked.push(trackedObject);\n              }\n            } else {\n              if (statusSnapshot[trackId] === XRTrackingState.Tracking) {\n                removed.push(trackedObject);\n                allTracked.splice(allTracked.indexOf(trackedObject), 1);\n              }\n              statusSnapshot[trackId] = trackedObject.state;\n            }\n          }\n          break;\n        default:\n          break;\n      }\n    }\n    for (let i = requestTrackings.length - 1; i >= 0; i--) {\n      requestTrackings[i].state === XRRequestTrackingState.Destroyed && requestTrackings.splice(i, 1);\n    }\n    if (added.length > 0 || updated.length > 0 || removed.length > 0) {\n      const listeners = this._listeners.getLoopArray();\n      for (let i = 0, n = listeners.length; i < n; i++) {\n        const listener = listeners[i];\n        !listener.destroyed && listener.fn(added, updated, removed);\n      }\n    }\n  }\n\n  override _onSessionStop(): void {\n    this._added.length = this._updated.length = this._removed.length = 0;\n  }\n\n  override _onSessionExit(): void {\n    // prettier-ignore\n    this._requestTrackings.length = this._tracked.length = this._added.length = this._updated.length = this._removed.length  = 0;\n    this._listeners.findAndRemove((value) => (value.destroyed = true));\n  }\n\n  protected _addRequestTracking(requestTracking: K): void {\n    const { _platformFeature: platformFeature } = this;\n    if (this._xrManager.sessionManager._platformSession && !platformFeature.canModifyRequestTrackingAfterInit) {\n      throw new Error(XRFeatureType[this._type] + \" request tracking cannot be modified after initialization.\");\n    }\n    this._requestTrackings.push(requestTracking);\n    platformFeature.onAddRequestTracking(requestTracking);\n  }\n\n  protected _removeRequestTracking(requestTracking: K): void {\n    const { _platformFeature: platformFeature } = this;\n    if (this._xrManager.sessionManager._platformSession && !platformFeature.canModifyRequestTrackingAfterInit) {\n      throw new Error(XRFeatureType[this._type] + \" request tracking cannot be modified after initialization.\");\n    }\n    platformFeature.onDelRequestTracking(requestTracking);\n  }\n\n  protected _removeAllRequestTrackings(): void {\n    const { _platformFeature: platformFeature } = this;\n    if (this._xrManager.sessionManager._platformSession && !platformFeature.canModifyRequestTrackingAfterInit) {\n      throw new Error(XRFeatureType[this._type] + \" request tracking cannot be modified after initialization.\");\n    }\n    const { _requestTrackings: requestTrackings } = this;\n    for (let i = 0, n = requestTrackings.length; i < n; i++) {\n      platformFeature.onDelRequestTracking(requestTrackings[i]);\n    }\n  }\n\n  protected abstract _generateTracked(): T;\n}\n","import { IXRTracked } from \"@galacean/engine-design\";\nimport { XRPose } from \"../../XRPose\";\nimport { XRTrackingState } from \"../../input/XRTrackingState\";\n\n/**\n * The base class of XR tracked object.\n */\nexport abstract class XRTracked implements IXRTracked {\n  /** The unique id of the trackable. */\n  id: number;\n  /** The pose of the trackable in XR space. */\n  pose: XRPose = new XRPose();\n  /** The tracking state of the trackable. */\n  state: XRTrackingState = XRTrackingState.NotTracking;\n}\n","import { IXRTracked } from \"@galacean/engine-design\";\nimport { TrackableType } from \"./TrackableType\";\nimport { Vector3 } from \"@galacean/engine\";\n\n/**\n * XR hit result.\n * It is the detection result returned by using XR HitTest feature.\n */\nexport class XRHitResult {\n  /** The position of the hit point. */\n  point: Vector3 = new Vector3();\n  /** The normal of the hit point. */\n  normal: Vector3 = new Vector3();\n  /** The distance from the origin of the ray to the hit point. */\n  distance: number;\n  /** The hit tracked object, such as IXRTrackedPlane. */\n  trackedObject: IXRTracked;\n  /** The type of tracked object detected, such as TrackableType.Plane */\n  trackableType: TrackableType;\n}\n","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n","import { XRRequestTrackingState } from \"./XRRequestTrackingState\";\nimport { XRTracked } from \"./XRTracked\";\n\n/**\n * @internal\n */\nexport abstract class XRRequestTracking<T extends XRTracked> {\n  /** The status of the current request tracking. */\n  state: XRRequestTrackingState = XRRequestTrackingState.None;\n  /** Tracked instances, make up from the tracking data returned by Session. */\n  tracked: T[] = [];\n}\n","import { IXRRequestPlane } from \"@galacean/engine-design\";\nimport { XRRequestTracking } from \"../XRRequestTracking\";\nimport { XRTrackedPlane } from \"./XRTrackedPlane\";\n\n/**\n * The request plane in XR space.\n */\nexport class XRRequestPlane extends XRRequestTracking<XRTrackedPlane> implements IXRRequestPlane {\n  /**\n   * @param detectionMode - The plane detection mode\n   */\n  constructor(public detectionMode: number) {\n    super();\n  }\n}\n","import { Vector3 } from \"@galacean/engine\";\nimport { IXRTrackedPlane } from \"@galacean/engine-design\";\nimport { XRTracked } from \"../XRTracked\";\nimport { XRPlaneMode } from \"./XRPlaneMode\";\n\n/**\n * The tracked plane in XR space.\n */\nexport class XRTrackedPlane extends XRTracked implements IXRTrackedPlane {\n  /** Whether the detected plane is horizontal or vertical. */\n  planeMode: XRPlaneMode;\n  /** The points that make up this plane.\n   *  Note: These points are in the plane coordinate system,\n   *  and their Y coordinates are all zero.\n   */\n  polygon: Vector3[] = [];\n  /**\n   * Whether this frame changes the attributes of the plane.\n   * Note: Includes `polygon` but no `pose`.\n   */\n  attributesDirty: boolean = false;\n}\n","import { XRManagerExtended, registerXRFeature } from \"../../../XRManagerExtended\";\nimport { XRFeatureType } from \"../../XRFeatureType\";\nimport { XRTrackableFeature } from \"../XRTrackableFeature\";\nimport { XRPlaneMode } from \"./XRPlaneMode\";\nimport { XRRequestPlane } from \"./XRRequestPlane\";\nimport { XRTrackedPlane } from \"./XRTrackedPlane\";\n\n/**\n * The manager of plane tracking feature.\n */\n@registerXRFeature(XRFeatureType.PlaneTracking)\nexport class XRPlaneTracking extends XRTrackableFeature<XRTrackedPlane, XRRequestPlane> {\n  /**\n   * The plane detection mode.\n   */\n  get detectionMode(): XRPlaneMode {\n    return this._requestTrackings[0].detectionMode;\n  }\n\n  /**\n   * The tracked planes.\n   */\n  get trackedPlanes(): readonly XRTrackedPlane[] {\n    return this._tracked;\n  }\n\n  /**\n   * @param xrManager - The xr manager\n   * @param detectionMode - The plane detection mode\n   */\n  constructor(xrManager: XRManagerExtended, detectionMode: XRPlaneMode = XRPlaneMode.EveryThing) {\n    super(xrManager, XRFeatureType.PlaneTracking, detectionMode);\n    this._addRequestTracking(new XRRequestPlane(detectionMode));\n  }\n\n  protected override _generateTracked(): XRTrackedPlane {\n    const plane = new XRTrackedPlane();\n    plane.id = XRTrackableFeature._uuid++;\n    return plane;\n  }\n}\n","import { Plane, Ray, Vector2, Vector3 } from \"@galacean/engine\";\nimport { IXRTrackedPlane } from \"@galacean/engine-design\";\nimport { XRManagerExtended, registerXRFeature } from \"../../XRManagerExtended\";\nimport { XRCamera } from \"../../input/XRCamera\";\nimport { XRTrackedInputDevice } from \"../../input/XRTrackedInputDevice\";\nimport { XRSessionMode } from \"../../session/XRSessionMode\";\nimport { XRFeature } from \"../XRFeature\";\nimport { XRFeatureType } from \"../XRFeatureType\";\nimport { XRPlaneTracking } from \"../trackable/plane/XRPlaneTracking\";\nimport { TrackableType } from \"./TrackableType\";\nimport { XRHitResult } from \"./XRHitResult\";\n\n/**\n * The manager of XR hit test.\n */\n@registerXRFeature(XRFeatureType.HitTest)\nexport class XRHitTest extends XRFeature {\n  private _tempRay: Ray = new Ray();\n  private _tempPlane: Plane = new Plane();\n  private _tempVec2: Vector2 = new Vector2();\n  private _tempVec30: Vector3 = new Vector3();\n  private _tempVec31: Vector3 = new Vector3();\n  private _tempVec32: Vector3 = new Vector3();\n  private _tempVec33: Vector3 = new Vector3();\n  private _tempVec34: Vector3 = new Vector3();\n  private _tempVec35: Vector3 = new Vector3();\n\n  /**\n   * @param xrManager - The xr manager\n   */\n  constructor(xrManager: XRManagerExtended) {\n    super(xrManager, XRFeatureType.HitTest);\n  }\n\n  /**\n   * Hit test.\n   * @param ray - The ray to test\n   * @param type - The type of hit test\n   * @returns The hit result\n   */\n  hitTest(ray: Ray, type: TrackableType): XRHitResult[] {\n    const result = [];\n    if (type & TrackableType.Plane) {\n      this._hitTestPlane(ray, result);\n    }\n    return result;\n  }\n\n  /**\n   * Screen hit test.\n   * @param x - The x coordinate of the screen point\n   * @param y - The y coordinate of the screen point\n   * @param type - The type of hit test\n   * @returns The hit result\n   */\n  screenHitTest(x: number, y: number, type: TrackableType): XRHitResult[] {\n    const { _xrManager: xrManager } = this;\n    if (xrManager.sessionManager.mode !== XRSessionMode.AR) {\n      throw new Error(\"Only AR mode supports using screen ray hit test.\");\n    }\n    const { _camera: camera } = xrManager.inputManager.getTrackedDevice<XRCamera>(XRTrackedInputDevice.Camera);\n    if (!camera) {\n      throw new Error(\"No camera available.\");\n    }\n    const ray = camera.screenPointToRay(this._tempVec2.set(x, y), this._tempRay);\n    return this.hitTest(ray, type);\n  }\n\n  private _hitTestPlane(ray: Ray, result: XRHitResult[]): void {\n    const planeManager = this._xrManager.getFeature(XRPlaneTracking);\n    if (!planeManager || !planeManager.enabled) {\n      throw new Error(\"The plane estimation function needs to be turned on for plane hit test.\");\n    }\n    const { _tempPlane: plane, _tempVec30: normal, _tempVec31: hitPoint, _tempVec32: hitPointInPlane } = this;\n    const { trackedPlanes } = planeManager;\n    for (let i = 0, n = trackedPlanes.length; i < n; i++) {\n      const trackedPlane = trackedPlanes[i];\n      normal.set(0, 1, 0).transformNormal(trackedPlane.pose.matrix);\n      plane.normal.copyFrom(normal);\n      plane.distance = -Vector3.dot(normal, trackedPlane.pose.position);\n      const distance = ray.intersectPlane(plane);\n      if (distance >= 0) {\n        ray.getPoint(distance, hitPoint);\n        Vector3.transformToVec3(hitPoint, trackedPlane.pose.inverseMatrix, hitPointInPlane);\n        // Check if the hit position is within the plane boundary.\n        if (this._checkPointerWithinPlane(hitPointInPlane, trackedPlane)) {\n          const hitResult = new XRHitResult();\n          hitResult.point.copyFrom(hitPoint);\n          hitResult.normal.copyFrom(normal);\n          hitResult.distance = distance;\n          hitResult.trackedObject = trackedPlane;\n          hitResult.trackableType = TrackableType.Plane;\n          result.push(hitResult);\n        }\n      }\n    }\n  }\n\n  private _checkPointerWithinPlane(pointer: Vector3, plane: IXRTrackedPlane): boolean {\n    const { _tempVec33: preToCur, _tempVec34: preToPointer, _tempVec35: cross } = this;\n    const { polygon } = plane;\n    const length = polygon.length;\n    let prePoint = polygon[length - 1];\n    let side = 0;\n    for (let i = 0; i < length; i++) {\n      const curPoint = polygon[i];\n      Vector3.subtract(curPoint, prePoint, preToCur);\n      Vector3.subtract(pointer, prePoint, preToPointer);\n      Vector3.cross(preToCur, preToPointer, cross);\n      const y = cross.y;\n      if (side === 0) {\n        if (y > 0) {\n          side = 1;\n        } else if (y < 0) {\n          side = -1;\n        }\n      } else {\n        if ((y > 0 && side < 0) || (y < 0 && side > 0)) {\n          return false;\n        }\n      }\n      prePoint = curPoint;\n    }\n    return true;\n  }\n}\n","import { XRTracked } from \"../XRTracked\";\n\n/**\n * The anchor in XR space.\n */\nexport class XRAnchor extends XRTracked {}\n","import { Quaternion, Vector3 } from \"@galacean/engine\";\nimport { IXRRequestAnchor } from \"@galacean/engine-design\";\nimport { XRRequestTracking } from \"../XRRequestTracking\";\nimport { XRAnchor } from \"./XRAnchor\";\n\n/**\n * The request anchor in XR space.\n */\nexport class XRRequestAnchor extends XRRequestTracking<XRAnchor> implements IXRRequestAnchor {\n  /**\n   * @param position - Requests the position of the anchor to be added\n   * @param rotation - Requests the rotation of the anchor to be added\n   */\n  constructor(\n    public position: Vector3,\n    public rotation: Quaternion\n  ) {\n    super();\n  }\n}\n","import { Quaternion, Vector3 } from \"@galacean/engine\";\nimport { XRManagerExtended, registerXRFeature } from \"../../../XRManagerExtended\";\nimport { XRFeatureType } from \"../../XRFeatureType\";\nimport { XRTrackableFeature } from \"../XRTrackableFeature\";\nimport { XRAnchor } from \"./XRAnchor\";\nimport { XRRequestAnchor } from \"./XRRequestAnchor\";\n\n/**\n * The manager of XR anchor tracking.\n */\n@registerXRFeature(XRFeatureType.AnchorTracking)\nexport class XRAnchorTracking extends XRTrackableFeature<XRAnchor, XRRequestAnchor> {\n  private _anchors: XRAnchor[] = [];\n\n  /**\n   * The anchors to tracking.\n   */\n  get trackingAnchors(): readonly XRAnchor[] {\n    return this._anchors;\n  }\n\n  /**\n   * The tracked anchors.\n   */\n  get trackedAnchors(): readonly XRAnchor[] {\n    return this._tracked;\n  }\n\n  /**\n   * @param xrManager - The xr manager\n   */\n  constructor(xrManager: XRManagerExtended) {\n    super(xrManager, XRFeatureType.AnchorTracking);\n  }\n\n  /**\n   * Add a anchor in XR space.\n   * @param anchor - The anchor to be added\n   */\n  addAnchor(position: Vector3, rotation: Quaternion): XRAnchor {\n    if (!this._enabled) {\n      throw new Error(\"Cannot add an anchor from a disabled anchor manager.\");\n    }\n    const { _anchors: anchors } = this;\n    const requestAnchor = new XRRequestAnchor(position, rotation);\n    const xrAnchor = this._generateTracked();\n    requestAnchor.tracked[0] = xrAnchor;\n    this._addRequestTracking(requestAnchor);\n    anchors.push(xrAnchor);\n    return xrAnchor;\n  }\n\n  /**\n   * Remove a anchor in XR space.\n   * @param anchor - The anchor to be removed\n   */\n  removeAnchor(anchor: XRAnchor): void {\n    if (!this._enabled) {\n      throw new Error(\"Cannot remove an anchor from a disabled anchor manager.\");\n    }\n    const { _requestTrackings: requestTrackings, _anchors: anchors } = this;\n    for (let i = 0, n = requestTrackings.length; i < n; i++) {\n      const requestAnchor = requestTrackings[i];\n      if (requestAnchor.tracked[0] === anchor) {\n        this._removeRequestTracking(requestAnchor);\n        break;\n      }\n    }\n    anchors.splice(anchors.indexOf(anchor), 1);\n  }\n\n  /**\n   * Remove all tracking anchors.\n   */\n  clearAnchors(): void {\n    if (!this._enabled) {\n      throw new Error(\"Cannot remove anchors from a disabled anchor manager.\");\n    }\n    this._removeAllRequestTrackings();\n  }\n\n  protected override _generateTracked(): XRAnchor {\n    const anchor = new XRAnchor();\n    anchor.id = XRTrackableFeature._uuid++;\n    return anchor;\n  }\n}\n","import { IXRRequestImage } from \"@galacean/engine-design\";\nimport { XRRequestTracking } from \"../XRRequestTracking\";\nimport { XRReferenceImage } from \"./XRReferenceImage\";\nimport { XRTrackedImage } from \"./XRTrackedImage\";\n\n/**\n * The request image in XR space.\n */\nexport class XRRequestImage extends XRRequestTracking<XRTrackedImage> implements IXRRequestImage {\n  /**\n   * @param image - The image to be tracked\n   */\n  constructor(public image: XRReferenceImage) {\n    super();\n  }\n}\n","import { IXRTrackedImage } from \"@galacean/engine-design\";\nimport { XRTracked } from \"../XRTracked\";\nimport { XRReferenceImage } from \"./XRReferenceImage\";\n\n/**\n * A tracked image in XR space.\n */\nexport class XRTrackedImage extends XRTracked implements IXRTrackedImage {\n  /** The reference image which was used to detect this image in the environment.  */\n  referenceImage: XRReferenceImage;\n  /** The width of the image in meters in the physical world. */\n  measuredPhysicalWidth: number;\n}\n","import { XRManagerExtended, registerXRFeature } from \"../../../XRManagerExtended\";\nimport { XRFeatureType } from \"../../XRFeatureType\";\nimport { XRTrackableFeature } from \"../XRTrackableFeature\";\nimport { XRReferenceImage } from \"./XRReferenceImage\";\nimport { XRRequestImage } from \"./XRRequestImage\";\nimport { XRTrackedImage } from \"./XRTrackedImage\";\n\n/**\n * The manager of XR image tracking.\n */\n@registerXRFeature(XRFeatureType.ImageTracking)\nexport class XRImageTracking extends XRTrackableFeature<XRTrackedImage, XRRequestImage> {\n  private _trackingImages: XRReferenceImage[];\n  /**\n   * The image to tracking.\n   */\n  get trackingImages(): readonly XRReferenceImage[] {\n    return this._trackingImages;\n  }\n\n  /**\n   * The tracked images.\n   */\n  get trackedImages(): readonly XRTrackedImage[] {\n    return this._tracked;\n  }\n\n  /**\n   * @param xrManager - The xr manager\n   * @param trackingImages - The images to be tracked\n   */\n  constructor(xrManager: XRManagerExtended, trackingImages: XRReferenceImage[]) {\n    super(xrManager, XRFeatureType.ImageTracking, trackingImages);\n    this._trackingImages = trackingImages;\n    const imageLength = trackingImages ? trackingImages.length : 0;\n    if (imageLength > 0) {\n      for (let i = 0, n = trackingImages.length; i < n; i++) {\n        this._addRequestTracking(new XRRequestImage(trackingImages[i]));\n      }\n    } else {\n      console.warn(\"No image to be tracked.\");\n    }\n  }\n\n  protected override _generateTracked(): XRTrackedImage {\n    const image = new XRTrackedImage();\n    image.id = XRTrackableFeature._uuid++;\n    return image;\n  }\n}\n","import { IXRReferenceImage } from \"@galacean/engine-design\";\n\n/**\n *  A reference image is an image to look for in the physical environment.\n */\nexport class XRReferenceImage implements IXRReferenceImage {\n  /**\n   * Create a reference image.\n   * @param name - The name of the image to be tracked\n   * @param imageSource - The image to be tracked\n   * @param physicalWidth - The expected physical width measurement for the real-world image being tracked in meters\n   */\n  constructor(\n    public name: string,\n    public imageSource: ImageBitmapSource,\n    public physicalWidth: number\n  ) {}\n}\n","function _extends() {\n    _extends = Object.assign || function assign(target) {\n        for (var i = 1; i < arguments.length; i++) {\n            var source = arguments[i];\n            for (var key in source) if (Object.prototype.hasOwnProperty.call(source, key)) target[key] = source[key];\n        }\n\n        return target;\n    };\n\n    return _extends.apply(this, arguments);\n}\nexport { _extends as _ };\n","import { BufferReader, Engine, decoder } from \"@galacean/engine\";\nimport { XRReferenceImage } from \"../feature/trackable/image/XRReferenceImage\";\n\n@decoder(\"XRReferenceImage\")\nexport class XRReferenceImageDecoder {\n  static decode(engine: Engine, bufferReader: BufferReader): Promise<XRReferenceImage> {\n    return new Promise((resolve, reject) => {\n      const physicalWidth = bufferReader.nextFloat32();\n      bufferReader.nextUint8();\n      const img = new Image();\n      img.onload = () => {\n        resolve(new XRReferenceImage(\"\", img, physicalWidth));\n      };\n      img.src = URL.createObjectURL(new window.Blob([bufferReader.nextImagesData(1)[0]]));\n    });\n  }\n}\n","import { AssetPromise, decode, Loader, LoadItem, resourceLoader, ResourceManager } from \"@galacean/engine\";\nimport { XRReferenceImage } from \"../feature/trackable/image/XRReferenceImage\";\n\n@resourceLoader(\"XRReferenceImage\", [])\nexport class XRReferenceImageLoader extends Loader<XRReferenceImage> {\n  load(item: LoadItem, resourceManager: ResourceManager): AssetPromise<XRReferenceImage> {\n    return new AssetPromise((resolve, reject) => {\n      resourceManager\n        // @ts-ignore\n        ._request<ArrayBuffer>(item.url, { ...item, type: \"arraybuffer\" })\n        .then((data) => {\n          decode<XRReferenceImage>(data, resourceManager.engine).then((referenceImage) => {\n            resolve(referenceImage);\n          });\n        })\n        .catch(reject);\n    });\n  }\n}\n"],"names":["_is_native_reflect_construct","result","Boolean","prototype","valueOf","call","Reflect","construct","_","_set_prototype_of","o","p","Object","setPrototypeOf","__proto__","_construct","Parent","args","Class","a","push","apply","instance","Function","bind","arguments","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","defineProperty","key","_create_class","Constructor","protoProps","staticProps","_inherits","subClass","superClass","TypeError","create","constructor","value","_instanceof","left","right","Symbol","hasInstance","XRTrackedInputDevice","XRSessionState","XRTrackingState","XRInputButton","XRInputEventType","XRTargetRayMode","XRSessionMode","XRFeatureType","XRRequestTrackingState","TrackableType","XRPlaneMode","XRCameraManager","_xrManager","attachCamera","type","camera","xrCamera","inputManager","getTrackedDevice","preCamera","_camera","_cameraType","CameraType","Normal","Camera","XRCenterCamera","LeftCamera","XRLeftCamera","RightCamera","XRRightCamera","detachCamera","_onSessionStart","_onUpdate","_cameras","_this__xrManager_inputManager","n","cameras","cameraDevice","transform","entity","pose","position","rotationQuaternion","rotation","viewport","x","y","width","height","z","w","set","Matrix","equals","projectionMatrix","_onSessionExit","_getIgnoreClearFlags","cameraType","CameraClearFlags","None","sessionManager","state","Running","Color","_onDestroy","fixedFoveation","_platformSession","_this__xrManager_sessionManager","platformSession","getFixedFoveation","Error","setFixedFoveation","XRPose","Vector3","Quaternion","matrix","inverseMatrix","XRInput","trackingState","NotTracking","XRCamera","_this","Rect","XRController","gripPose","targetRayPose","pressedButtons","down","up","isButtonDown","button","isButtonUp","isButtonHeldDown","XRInputManager","_engine","_controllers","_added","_removed","_trackedDevices","_statusSnapshot","_listeners","SafeLoopArray","trackedDevices","controllers","Controller","LeftController","RightController","fill","addTrackedDeviceChangedListener","listener","fn","removeTrackedDeviceChangedListener","findAndRemove","destroyed","added","removed","statusSnapshot","_this1","controller","platformEvents","events","_handleEvent","resetEvents","frame","updateInputs","input","nowState","Tracking","listeners","getLoopArray","_proto","event","targetRayMode","TrackedPointer","SelectStart","Select","SelectEnd","SqueezeStart","Squeeze","SqueezeEnd","Screen","engine","_pointerManager","_target","canvas","_webCanvas","clientWidth","clientHeight","clientX","clientY","dispatchEvent","_makeUpPointerEvent","id","pointerId","eventInitDict","buttons","PointerEvent","XRSessionManager","_mode","_state","_rhi","_hardwareRenderer","_raf","requestAnimationFrame","window","_caf","cancelAnimationFrame","isSupportedMode","mode","_platformDevice","isSupportedSessionMode","run","start","_setState","isPaused","pause","resume","stop","rhi","_mainFrameBuffer","_mainFrameWidth","_mainFrameHeight","Paused","_onSessionStop","addStateChangedListener","removeStateChangedListener","_initialize","features","Promise","resolve","reject","platformFeatures","platformFeature","_platformFeature","xrManager","requestSession","then","Initialized","setSessionExitCallBack","addEventListener","_onSessionInit","framebuffer","framebufferWidth","framebufferHeight","_getRequestAnimationFrame","_getCancelAnimationFrame","_exit","end","removeEventListener","supportedFrameRate","supportedFrameRates","frameRate","XRManagerExtended","XRManager","isSupportedFeature","feature","_featureMap","get","addFeature","_len","Array","_key","getFeature","enterXR","sessionMode","autoRun","_origin","Initializing","exitXR","xrDevice","_features","cameraManager","_update","enabled","_destroy","_getCameraIgnoreClearFlags","origin","registerXRFeature","Map","ApplyMixins","derivedCtor","baseCtors","forEach","baseCtor","getOwnPropertyNames","name","getOwnPropertyDescriptor","XRFeature","_type","_enabled","createPlatformFeature","_onEnable","_onDisable","XRTrackableFeature","_requestTrackings","_tracked","_updated","addChangedListener","removeChangedListener","platformFrame","requestTrackings","allTracked","updated","checkAvailable","getTrackedResult","_generateTracked","requestTracking","Destroyed","destroyedTracked","tracked","j","trackId","splice","indexOf","Resolved","trackedObject","_addRequestTracking","canModifyRequestTrackingAfterInit","onAddRequestTracking","_removeRequestTracking","onDelRequestTracking","_removeAllRequestTrackings","_uuid","XRTracked","XRHitResult","point","normal","__decorate","decorators","desc","d","c","r","decorate","SuppressedError","XRRequestTracking","XRRequestPlane","detectionMode","XRTrackedPlane","polygon","attributesDirty","exports","XRPlaneTracking","XRTrackableFeature1","EveryThing","PlaneTracking","plane","trackedPlanes","XRHitTest","HitTest","_tempRay","Ray","_tempPlane","Plane","_tempVec2","Vector2","_tempVec30","_tempVec31","_tempVec32","_tempVec33","_tempVec34","_tempVec35","hitTest","ray","_hitTestPlane","screenHitTest","AR","screenPointToRay","planeManager","hitPointInPlane","trackedPlane","transformNormal","copyFrom","distance","dot","intersectPlane","getPoint","hitPoint","transformToVec3","_checkPointerWithinPlane","hitResult","trackableType","pointer","preToCur","preToPointer","cross","prePoint","side","curPoint","subtract","XRAnchor","XRRequestAnchor","XRAnchorTracking","AnchorTracking","_anchors","addAnchor","anchors","requestAnchor","xrAnchor","removeAnchor","anchor","clearAnchors","trackingAnchors","trackedAnchors","XRRequestImage","image","XRTrackedImage","XRImageTracking","trackingImages","ImageTracking","_trackingImages","imageLength","console","warn","trackedImages","XRReferenceImage","imageSource","physicalWidth","_extends","assign","source","hasOwnProperty","XRReferenceImageDecoder","decode","bufferReader","nextFloat32","nextUint8","img","Image","onload","src","URL","createObjectURL","Blob","nextImagesData","XRReferenceImageLoader","Loader","load","item","resourceManager","AssetPromise","_request","url","data","referenceImage","catch"],"mappings":"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"}